{"version":3,"sources":["js/widget.min.js"],"names":["WIDGET_COMMON_CONFIG","AUTH_PATH_URL","LOGGER_CLIENT_ID","LOGGER_CLIENT_SECRET","LOGGER_REFRESH_TOKEN","STORE_URL","RiseVision","Common","LoggerUtils","displayId","companyId","version","getEventParams","params","cb","json","event","file_url","file_format","getFileFormat","company_id","display_id","getSuffix","date","Date","year","getUTCFullYear","month","getUTCMonth","day","getUTCDate","url","hasParams","str","substr","lastIndexOf","test","indexOf","length","toLowerCase","getInsertData","BASE_INSERT_SCHEMA","data","JSON","parse","stringify","rows","insertId","Math","random","toString","toUpperCase","ts","toISOString","logEvent","table","Logger","log","logEventToPlayer","top","postToPlayer","message","suffix","err","console","setIds","company","display","setVersion","value","utils","REFRESH_URL","serviceUrl","throttle","throttleDelay","lastEvent","refreshDate","token","refreshToken","xhr","XMLHttpRequest","open","onloadend","resp","response","e","warn","access_token","refreshedAt","send","isThrottled","tableName","hasOwnProperty","enableWidgetLogging","setTimeout","insertWithToken","refreshData","insertData","replace","setRequestHeader","Utilities","getFontCssStyle","className","fontObj","family","decodeURIComponent","font","color","forecolor","size","weight","bold","italic","underline","highlight","highlightColor","backcolor","addCSSRules","rules","style","document","createElement","i","appendChild","createTextNode","head","loadFonts","settings","families","googleFamilies","customFamilies","customUrls","callback","onGoogleFontsLoaded","forEach","item","class","fontStyle","type","split","push","j","loadCustomFont","loadGoogleFonts","contentDoc","sheet","rule","styleSheets","addRule","WebFont","load","google","active","inactive","timeout","loadScript","src","script","body","preloadImages","urls","images","Image","getQueryParameter","param","getQueryStringParameter","window","location","search","substring","query","vars","pair","getDateObjectFromPlayerVersionString","playerVersion","reggie","dateArray","exec","getRiseCacheErrorMessage","statusCode","errorMessage","unescapeHTML","html","div","innerHTML","textContent","hasInternetConnection","filePath","getTime","status","isLegacy","legacyVersion","match","navigator","userAgent","parseInt","addProtocol","secure","RiseCache","BASE_CACHE_URL","_pingReceived","_isCacheRunning","_isV2Running","_isHttps","_utils","_RC_VERSION_WITH_ENCODE","_RC_VERSION","ping","r","self","onreadystatechange","readyState","responseObject","responseText","debug","description","getFile","fileUrl","nocachebuster","totalCacheRequests","fileRequest","separator","_compareVersionNumbers","encodeURIComponent","makeRequest","v1","v2","v1parts","v2parts","isPositiveInteger","x","validateParts","parts","NaN","method","request","addEventListener","Error","getErrorMessage","isRiseCacheRunning","isV2Running","isRCV2Player","isV3PlayerVersionWithRCV2","RC_V2_FIRST_PLAYER_VERSION_DATE","sysInfoViewerParameter","parentParameter","playerVersionString","playerVersionDate","reset","angular","module","constant","config","STORAGE_ENV","COMPONENTS_PATH","Video","gadgets","_additionalParams","_mode","_displayId","_isLoading","_configDetails","_prefs","_storage","_nonStorage","_message","_player","_viewerPaused","_resume","_currentFiles","_currentPlaylistIndex","_errorLog","_errorTimer","_errorFlag","_storageErrorFlag","_playerErrorFlag","_unavailableFlag","_done","rpc","call","getString","_ready","_clearErrorTimer","clearTimeout","_startErrorTimer","_getCurrentFile","_resetErrorFlags","hasStorageError","hasPlayerError","showError","isStorageError","show","isError","getTableName","onFileInit","hide","play","onFileRefresh","update","onFileUnavailable","pause","event_details","retry","PlayerVJS","init","playerEnded","playerReady","playerItemChange","index","setAdditionalParams","mode","isStorageFile","_","clone","Prefs","getElementById","width","getInt","height","video","resume","Message","Object","keys","storage","NonStorage","StorageFile","StorageFolder","playerError","error","errorTypes","code","stop","PlayerUtils","getVideoFileType","extensions","urlLowercase","getAspectRatio","gcd","a","b","_initialLoad","riseCache","detail","changed","currentTarget","isV2","isPlayerRunning","setAttribute","folder","fileName","go","_files","_getUrls","pluck","_getExistingFile","file","find","f","name","_deleteFile","existing","splice","_changeFile","_addFile","slice","sortedIndex","added","deleted","_refreshDuration","_refreshIntervalId","_url","_getFile","omitCacheBuster","_startRefreshInterval","setInterval","selector","_autoPlay","_playerInstance","_fileCount","_updateWaiting","_isPaused","_pauseTimer","_pause","_disableFullscreen","_getOptions","controls","fluid","scaleToFit","_onPause","restart","paused","_onEnded","playlist","currentItem","next","_onError","_onLoadedMetaData","placeholderWidth","placeholderHeight","placeholderAspect","videoWidth","videoHeight","videoAspect","currentSrc","_initPlaylist","playlistItem","sources","source","addPlaylistItem","_configureHandlers","on","_setVolume","volume","Number","isInteger","files","autoplay","isNaN","videojs","_removeLoadingSpinner","loadingSpinnerComponent","getChild","removeChild","remainingTime","currentTime","mainContainer","messageContainer","_active","_init","firstChild","fragment","createDocumentFragment","p","querySelector","prefs","id","oncontextmenu","configure","names","values","additionalParams","Array","isArray","register","link","webcomponents","href","storageReady","polymerReady","onPolymerReady","removeEventListener","onStorageReady","getElementsByTagName","_gaq","ga","async","protocol","s","parentNode","insertBefore"],"mappings":"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","file":"widget.min.js","sourcesContent":["/* exported WIDGET_COMMON_CONFIG */\nvar WIDGET_COMMON_CONFIG = {\n  AUTH_PATH_URL: \"v1/widget/auth\",\n  LOGGER_CLIENT_ID: \"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com\",\n  LOGGER_CLIENT_SECRET: \"nlZyrcPLg6oEwO9f9Wfn29Wh\",\n  LOGGER_REFRESH_TOKEN: \"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT\",\n  STORE_URL: \"https://store-dot-rvaserver2.appspot.com/\"\n};\n/* global WIDGET_COMMON_CONFIG */\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.LoggerUtils = (function() {\n  \"use strict\";\n\n   var displayId = \"\",\n     companyId = \"\",\n     version = null;\n\n  /*\n   *  Private Methods\n   */\n\n  /* Retrieve parameters to pass to the event logger. */\n  function getEventParams(params, cb) {\n    var json = null;\n\n    // event is required.\n    if (params.event) {\n      json = params;\n\n      if (json.file_url) {\n        json.file_format = getFileFormat(json.file_url);\n      }\n\n      json.company_id = companyId;\n      json.display_id = displayId;\n\n      if (version) {\n        json.version = version;\n      }\n\n      cb(json);\n    }\n    else {\n      cb(json);\n    }\n  }\n\n  // Get suffix for BQ table name.\n  function getSuffix() {\n    var date = new Date(),\n      year = date.getUTCFullYear(),\n      month = date.getUTCMonth() + 1,\n      day = date.getUTCDate();\n\n    if (month < 10) {\n      month = \"0\" + month;\n    }\n\n    if (day < 10) {\n      day = \"0\" + day;\n    }\n\n    return \"\" + year + month + day;\n  }\n\n  /*\n   *  Public Methods\n   */\n  function getFileFormat(url) {\n    var hasParams = /[?#&]/,\n      str;\n\n    if (!url || typeof url !== \"string\") {\n      return null;\n    }\n\n    str = url.substr(url.lastIndexOf(\".\") + 1);\n\n    // don't include any params after the filename\n    if (hasParams.test(str)) {\n      str = str.substr(0 ,(str.indexOf(\"?\") !== -1) ? str.indexOf(\"?\") : str.length);\n\n      str = str.substr(0, (str.indexOf(\"#\") !== -1) ? str.indexOf(\"#\") : str.length);\n\n      str = str.substr(0, (str.indexOf(\"&\") !== -1) ? str.indexOf(\"&\") : str.length);\n    }\n\n    return str.toLowerCase();\n  }\n\n  function getInsertData(params) {\n    var BASE_INSERT_SCHEMA = {\n      \"kind\": \"bigquery#tableDataInsertAllRequest\",\n      \"skipInvalidRows\": false,\n      \"ignoreUnknownValues\": false,\n      \"templateSuffix\": getSuffix(),\n      \"rows\": [{\n        \"insertId\": \"\"\n      }]\n    },\n    data = JSON.parse(JSON.stringify(BASE_INSERT_SCHEMA));\n\n    data.rows[0].insertId = Math.random().toString(36).substr(2).toUpperCase();\n    data.rows[0].json = JSON.parse(JSON.stringify(params));\n    data.rows[0].json.ts = new Date().toISOString();\n\n    return data;\n  }\n\n  function logEvent(table, params) {\n    getEventParams(params, function(json) {\n      if (json !== null) {\n        RiseVision.Common.Logger.log(table, json);\n      }\n    });\n  }\n\n  function logEventToPlayer(table, params) {\n    try {\n      top.postToPlayer( {\n        message: \"widget-log\",\n        table: table,\n        params: JSON.stringify(params),\n        suffix: getSuffix()\n      } );\n    } catch (err) {\n      console.log(\"widget-common.logEventToPlayer\", err);\n    }\n  }\n\n  /* Set the Company and Display IDs. */\n  function setIds(company, display) {\n    companyId = company;\n    displayId = display;\n  }\n\n  function setVersion(value) {\n    version = value;\n  }\n\n  return {\n    \"getInsertData\": getInsertData,\n    \"getFileFormat\": getFileFormat,\n    \"logEvent\": logEvent,\n    \"logEventToPlayer\": logEventToPlayer,\n    \"setIds\": setIds,\n    \"setVersion\": setVersion\n  };\n})();\n\nRiseVision.Common.Logger = (function(utils) {\n  \"use strict\";\n\n  var REFRESH_URL = \"https://www.googleapis.com/oauth2/v3/token?client_id=\" + WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID +\n      \"&client_secret=\" + WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET +\n      \"&refresh_token=\" + WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN +\n      \"&grant_type=refresh_token\";\n\n  var serviceUrl = \"https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll\",\n    throttle = false,\n    throttleDelay = 1000,\n    lastEvent = \"\",\n    refreshDate = 0,\n    token = \"\";\n\n  /*\n   *  Private Methods\n   */\n  function refreshToken(cb) {\n    var xhr = new XMLHttpRequest();\n\n    if (new Date() - refreshDate < 3580000) {\n      return cb({});\n    }\n\n    xhr.open(\"POST\", REFRESH_URL, true);\n    xhr.onloadend = function() {\n      var resp = {};\n      try {\n        resp = JSON.parse(xhr.response);\n      } catch(e) {\n        console.warn(\"Can't refresh logger token - \", e.message);\n      }\n      cb({ token: resp.access_token, refreshedAt: new Date() });\n    };\n\n    xhr.send();\n  }\n\n  function isThrottled(event) {\n    return throttle && (lastEvent === event);\n  }\n\n  /*\n   *  Public Methods\n   */\n  function log(tableName, params) {\n    if (!tableName || !params || (params.hasOwnProperty(\"event\") && !params.event) ||\n      (params.hasOwnProperty(\"event\") && isThrottled(params.event))) {\n      return;\n    }\n\n    // don't log if display id is invalid or preview/local\n    if (!params.display_id || params.display_id === \"preview\" || params.display_id === \"display_id\" ||\n      params.display_id === \"displayId\") {\n      return;\n    }\n\n    try {\n      if ( top.postToPlayer && top.enableWidgetLogging ) {\n        // send log data to player instead of BQ\n        return utils.logEventToPlayer( tableName, params );\n      }\n    } catch ( e ) {\n      console.log( \"widget-common: logger\", e );\n    }\n\n    throttle = true;\n    lastEvent = params.event;\n\n    setTimeout(function () {\n      throttle = false;\n    }, throttleDelay);\n\n    function insertWithToken(refreshData) {\n      var xhr = new XMLHttpRequest(),\n        insertData, url;\n\n      url = serviceUrl.replace(\"TABLE_ID\", tableName);\n      refreshDate = refreshData.refreshedAt || refreshDate;\n      token = refreshData.token || token;\n      insertData = utils.getInsertData(params);\n\n      // Insert the data.\n      xhr.open(\"POST\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n\n      if (params.cb && typeof params.cb === \"function\") {\n        xhr.onloadend = function() {\n          params.cb(xhr.response);\n        };\n      }\n\n      xhr.send(JSON.stringify(insertData));\n    }\n\n    return refreshToken(insertWithToken);\n  }\n\n  return {\n    \"log\": log\n  };\n})(RiseVision.Common.LoggerUtils);\n\n/* global WebFont */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.Utilities = (function() {\n\n  function getFontCssStyle(className, fontObj) {\n    var family = \"font-family: \" + decodeURIComponent(fontObj.font.family).replace(/'/g, \"\") + \"; \";\n    var color = \"color: \" + (fontObj.color ? fontObj.color : fontObj.forecolor) + \"; \";\n    var size = \"font-size: \" + (fontObj.size.indexOf(\"px\") === -1 ? fontObj.size + \"px; \" : fontObj.size + \"; \");\n    var weight = \"font-weight: \" + (fontObj.bold ? \"bold\" : \"normal\") + \"; \";\n    var italic = \"font-style: \" + (fontObj.italic ? \"italic\" : \"normal\") + \"; \";\n    var underline = \"text-decoration: \" + (fontObj.underline ? \"underline\" : \"none\") + \"; \";\n    var highlight = \"background-color: \" + (fontObj.highlightColor ? fontObj.highlightColor : fontObj.backcolor) + \";\";\n\n    return \".\" + className + \" {\" + family + color + size + weight + italic + underline + highlight + \"}\";\n  }\n\n  function addCSSRules(rules) {\n    var style = document.createElement(\"style\");\n\n    for (var i = 0, length = rules.length; i < length; i++) {\n      style.appendChild(document.createTextNode(rules[i]));\n    }\n\n    document.head.appendChild(style);\n  }\n\n  /*\n   * Loads Google or custom fonts, if applicable, and injects CSS styles\n   * into the head of the document.\n   *\n   * @param    array    settings    Array of objects with the following form:\n *                                   [{\n *                                     \"class\": \"date\",\n *                                     \"fontSetting\": {\n *                                         bold: true,\n *                                         color: \"black\",\n *                                         font: {\n *                                           family: \"Akronim\",\n *                                           font: \"Akronim\",\n *                                           name: \"Verdana\",\n *                                           type: \"google\",\n *                                           url: \"http://custom-font-url\"\n *                                         },\n *                                         highlightColor: \"transparent\",\n *                                         italic: false,\n *                                         size: \"20\",\n *                                         underline: false\n *                                     }\n *                                   }]\n   *\n   *           object   contentDoc    Document object into which to inject styles\n   *                                  and load fonts (optional).\n   */\n  function loadFonts(settings, cb) {\n    var families = null,\n      googleFamilies = [],\n      customFamilies = [],\n      customUrls = [];\n\n    function callback() {\n      if (cb && typeof cb === \"function\") {\n        cb();\n      }\n    }\n\n    function onGoogleFontsLoaded() {\n      callback();\n    }\n\n    if (!settings || settings.length === 0) {\n      callback();\n      return;\n    }\n\n    // Check for custom css class names and add rules if so\n    settings.forEach(function(item) {\n      if (item.class && item.fontStyle) {\n        addCSSRules([ getFontCssStyle(item.class, item.fontStyle) ]);\n      }\n    });\n\n    // Google fonts\n    for (var i = 0; i < settings.length; i++) {\n      if (settings[i].fontStyle && settings[i].fontStyle.font.type &&\n        (settings[i].fontStyle.font.type === \"google\")) {\n        // Remove fallback font.\n        families = settings[i].fontStyle.font.family.split(\",\")[0];\n\n        // strip possible single quotes\n        families = families.replace(/'/g, \"\");\n\n        googleFamilies.push(families);\n      }\n    }\n\n    // Custom fonts\n    for (i = 0; i < settings.length; i++) {\n      if (settings[i].fontStyle && settings[i].fontStyle.font.type &&\n        (settings[i].fontStyle.font.type === \"custom\")) {\n        // decode value and strip single quotes\n        customFamilies.push(decodeURIComponent(settings[i].fontStyle.font.family).replace(/'/g, \"\"));\n        // strip single quotes\n        customUrls.push(settings[i].fontStyle.font.url.replace(/'/g, \"\\\\'\"));\n      }\n    }\n\n    if (googleFamilies.length === 0 && customFamilies.length === 0) {\n      callback();\n    }\n    else {\n      // Load the fonts\n      for (var j = 0; j < customFamilies.length; j += 1) {\n        loadCustomFont(customFamilies[j], customUrls[j]);\n      }\n\n      if (googleFamilies.length > 0) {\n        loadGoogleFonts(googleFamilies, onGoogleFontsLoaded);\n      }\n      else {\n        callback();\n      }\n    }\n  }\n\n  function loadCustomFont(family, url, contentDoc) {\n    var sheet = null;\n    var rule = \"font-family: \" + family + \"; \" + \"src: url('\" + url + \"');\";\n\n    contentDoc = contentDoc || document;\n\n    sheet = contentDoc.styleSheets[0];\n\n    if (sheet !== null) {\n      sheet.addRule(\"@font-face\", rule);\n    }\n  }\n\n  function loadGoogleFonts(families, cb) {\n    WebFont.load({\n      google: {\n        families: families\n      },\n      active: function() {\n        if (cb && typeof cb === \"function\") {\n          cb();\n        }\n      },\n      inactive: function() {\n        if (cb && typeof cb === \"function\") {\n          cb();\n        }\n      },\n      timeout: 2000\n    });\n  }\n\n  function loadScript( src ) {\n    var script = document.createElement( \"script\" );\n\n    script.src = src;\n    document.body.appendChild( script );\n  }\n\n  function preloadImages(urls) {\n    var length = urls.length,\n      images = [];\n\n    for (var i = 0; i < length; i++) {\n      images[i] = new Image();\n      images[i].src = urls[i];\n    }\n  }\n\n  /**\n   * Get the current URI query param\n   */\n  function getQueryParameter(param) {\n    return getQueryStringParameter(param, window.location.search.substring(1));\n  }\n\n  /**\n   * Get the query parameter from a query string\n   */\n  function getQueryStringParameter(param, query) {\n    var vars = query.split(\"&\"),\n      pair;\n\n    for (var i = 0; i < vars.length; i++) {\n      pair = vars[i].split(\"=\");\n\n      if (pair[0] == param) { // jshint ignore:line\n        return decodeURIComponent(pair[1]);\n      }\n    }\n\n    return \"\";\n  }\n\n  /**\n   * Get date object from player version string\n   */\n  function getDateObjectFromPlayerVersionString(playerVersion) {\n    var reggie = /(\\d{4})\\.(\\d{2})\\.(\\d{2})\\.(\\d{2})\\.(\\d{2})/;\n    var dateArray = reggie.exec(playerVersion);\n    if (dateArray) {\n      return new Date(\n        (+dateArray[1]),\n          (+dateArray[2])-1, // Careful, month starts at 0!\n        (+dateArray[3]),\n        (+dateArray[4]),\n        (+dateArray[5])\n      );\n    } else {\n      return;\n    }\n  }\n\n  function getRiseCacheErrorMessage(statusCode) {\n    var errorMessage = \"\";\n    switch (statusCode) {\n      case 404:\n        errorMessage = \"The file does not exist or cannot be accessed.\";\n        break;\n      case 507:\n        errorMessage = \"There is not enough disk space to save the file on Rise Cache.\";\n        break;\n      default:\n        errorMessage = \"There was a problem retrieving the file from Rise Cache.\";\n    }\n\n    return errorMessage;\n  }\n\n  function unescapeHTML(html) {\n    var div = document.createElement(\"div\");\n\n    div.innerHTML = html;\n\n    return div.textContent;\n  }\n\n  function hasInternetConnection(filePath, callback) {\n    var xhr = new XMLHttpRequest();\n\n    if (!filePath || !callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    xhr.open(\"HEAD\", filePath + \"?cb=\" + new Date().getTime(), false);\n\n    try {\n      xhr.send();\n\n      callback((xhr.status >= 200 && xhr.status < 304));\n\n    } catch (e) {\n      callback(false);\n    }\n  }\n\n  /**\n   * Check if chrome version is under a certain version\n   */\n  function isLegacy() {\n    var legacyVersion = 25;\n\n    var match = navigator.userAgent.match(/Chrome\\/(\\S+)/);\n    var version = match ? match[1] : 0;\n\n    if (version) {\n      version = parseInt(version.substring(0,version.indexOf(\".\")));\n\n      if (version <= legacyVersion) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Adds http:// or https:// protocol to url if the protocol is missing\n   */\n  function addProtocol(url, secure) {\n    if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n      url = ((secure) ? \"https://\" : \"http://\") + url;\n    }\n    return url;\n  }\n\n  return {\n    addProtocol:              addProtocol,\n    getQueryParameter:        getQueryParameter,\n    getQueryStringParameter:  getQueryStringParameter,\n    getFontCssStyle:          getFontCssStyle,\n    addCSSRules:              addCSSRules,\n    loadFonts:                loadFonts,\n    loadCustomFont:           loadCustomFont,\n    loadGoogleFonts:          loadGoogleFonts,\n    loadScript:               loadScript,\n    preloadImages:            preloadImages,\n    getRiseCacheErrorMessage: getRiseCacheErrorMessage,\n    unescapeHTML:             unescapeHTML,\n    hasInternetConnection:    hasInternetConnection,\n    isLegacy:                 isLegacy,\n    getDateObjectFromPlayerVersionString: getDateObjectFromPlayerVersionString\n  };\n})();\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.RiseCache = (function () {\n  \"use strict\";\n\n  var BASE_CACHE_URL = \"http://localhost:9494/\";\n\n  var _pingReceived = false,\n    _isCacheRunning = false,\n    _isV2Running = false,\n    _isHttps = true,\n    _utils = RiseVision.Common.Utilities,\n    _RC_VERSION_WITH_ENCODE = \"1.7.3\",\n    _RC_VERSION = \"\";\n\n  function ping(callback) {\n    var r = new XMLHttpRequest(),\n      /* jshint validthis: true */\n      self = this;\n\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_isV2Running) {\n      r.open(\"GET\", BASE_CACHE_URL + \"ping?callback=_\", true);\n    }\n    else {\n      r.open(\"GET\", BASE_CACHE_URL, true);\n    }\n\n    r.onreadystatechange = function () {\n      try {\n        if (r.readyState === 4 ) {\n          // save this result for use in getFile()\n          _pingReceived = true;\n\n          if(r.status === 200) {\n            _isCacheRunning = true;\n\n            try {\n              var responseObject = (r.responseText) ? JSON.parse(r.responseText) : \"\";\n              if (responseObject) {\n                _RC_VERSION = responseObject.version;\n              }\n            }\n            catch(e) {\n              console.log(e);\n            }\n\n            callback(true, r.responseText);\n          } else if (r.status === 404) {\n            // Rise Cache V2 is running\n            _isV2Running = true;\n\n            BASE_CACHE_URL = \"https://localhost:9495/\";\n\n            // call ping again so correct ping URL is used for Rise Cache V2\n            return self.ping(callback);\n          } else {\n\n            if ( _isHttps ) {\n              _isV2Running = true;\n              _isHttps = false;\n              BASE_CACHE_URL = \"http://localhost:9494/\";\n\n              // call ping again so correct ping URL is used for Rise Cache V2 HTTPs\n              return self.ping(callback);\n            } else {\n              console.debug(\"Rise Cache is not running\");\n              _isV2Running = false;\n              _isCacheRunning = false;\n\n              callback(false, null);\n            }\n          }\n        }\n      }\n      catch (e) {\n        console.debug(\"Caught exception: \", e.description);\n      }\n\n    };\n    r.send();\n  }\n\n  function getFile(fileUrl, callback, nocachebuster) {\n    if (!fileUrl || !callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    var totalCacheRequests = 0;\n\n    function fileRequest() {\n      var url, str, separator;\n\n      if (_isCacheRunning) {\n        if (_isV2Running) {\n          if ( _compareVersionNumbers( _RC_VERSION, _RC_VERSION_WITH_ENCODE ) > 0 ) {\n            url = BASE_CACHE_URL + \"files?url=\" + fileUrl;\n          } else {\n            url = BASE_CACHE_URL + \"files?url=\" + encodeURIComponent(fileUrl);\n          }\n        } else {\n          // configure url with cachebuster or not\n          url = (nocachebuster) ? BASE_CACHE_URL + \"?url=\" + encodeURIComponent(fileUrl) :\n          BASE_CACHE_URL + \"cb=\" + new Date().getTime() + \"?url=\" + encodeURIComponent(fileUrl);\n        }\n      } else {\n        if (nocachebuster) {\n          url = fileUrl;\n        } else {\n          str = fileUrl.split(\"?\");\n          separator = (str.length === 1) ? \"?\" : \"&\";\n          url = fileUrl + separator + \"cb=\" + new Date().getTime();\n        }\n      }\n\n      makeRequest(\"HEAD\", url);\n    }\n\n    function _compareVersionNumbers( v1, v2 ) {\n      var v1parts = v1.split( \".\" ),\n        v2parts = v2.split( \".\" ),\n        i = 0;\n\n      function isPositiveInteger( x ) {\n        return /^\\d+$/.test( x );\n      }\n\n      // First, validate both numbers are true version numbers\n      function validateParts( parts ) {\n        for ( i = 0; i < parts.length; i++ ) {\n          if ( !isPositiveInteger( parts[ i ] ) ) {\n            return false;\n          }\n        }\n        return true;\n      }\n      if ( !validateParts( v1parts ) || !validateParts( v2parts ) ) {\n        return NaN;\n      }\n\n      for ( i = 0; i < v1parts.length; ++i ) {\n        if ( v2parts.length === i ) {\n          return 1;\n        }\n\n        if ( v1parts[ i ] === v2parts[ i ] ) {\n          continue;\n        }\n        if ( v1parts[ i ] > v2parts[ i ] ) {\n          return 1;\n        }\n        return -1;\n      }\n\n      if ( v1parts.length !== v2parts.length ) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function makeRequest(method, url) {\n      var xhr = new XMLHttpRequest(),\n        request = {\n          xhr: xhr,\n          url: url\n        };\n\n      if (_isCacheRunning) {\n        xhr.open(method, url, true);\n\n        xhr.addEventListener(\"loadend\", function () {\n          var status = xhr.status || 0;\n          if (status === 202) {\n              totalCacheRequests++;\n              if (totalCacheRequests < 3) {\n                setTimeout(function(){ makeRequest(method, url); }, 3000);\n              } else {\n                  callback(request, new Error(\"File is downloading\"));\n              }\n          } else if (status >= 200 && status < 300) {\n            callback(request);\n          } else {\n            // Server may not support HEAD request. Fallback to a GET request.\n            if (method === \"HEAD\") {\n              makeRequest(\"GET\", url);\n            } else {\n              callback(request, new Error(\"The request failed with status code: \" + status));\n            }\n          }\n        });\n\n        xhr.send();\n      }\n      else {\n        // Rise Cache is not running (preview), skip HEAD request and execute callback immediately\n        callback(request);\n      }\n\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(fileRequest);\n    } else {\n      return fileRequest();\n    }\n\n  }\n\n  function getErrorMessage(statusCode) {\n    var errorMessage = \"\";\n    switch (statusCode) {\n      case 502:\n        errorMessage = \"There was a problem retrieving the file.\";\n        break;\n      case 504:\n        errorMessage = \"Unable to download the file. The server is not responding.\";\n        break;\n      case 507:\n        errorMessage = \"There is not enough disk space to save the file on Rise Cache.\";\n        break;\n      case 534:\n        errorMessage = \"The file does not exist or cannot be accessed.\";\n        break;\n      default:\n        errorMessage = \"\";\n    }\n\n    return errorMessage;\n  }\n\n  function isRiseCacheRunning(callback) {\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(function () {\n        callback(_isCacheRunning);\n      });\n    } else {\n      callback(_isCacheRunning);\n    }\n  }\n\n  function isV2Running(callback) {\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(function () {\n        callback(_isV2Running);\n      });\n    }\n    else {\n      callback(_isV2Running);\n    }\n  }\n\n  function isRCV2Player(callback) {\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n    /* jshint validthis: true */\n    return this.isV2Running(function (isV2Running) {\n      if (isV2Running) {\n        callback(isV2Running);\n      } else {\n        callback(isV3PlayerVersionWithRCV2());\n      }\n    });\n  }\n\n  function isV3PlayerVersionWithRCV2() {\n    var RC_V2_FIRST_PLAYER_VERSION_DATE = _utils.getDateObjectFromPlayerVersionString(\"2016.10.10.00.00\");\n\n    var sysInfoViewerParameter = _utils.getQueryParameter(\"sysInfo\");\n    if (!sysInfoViewerParameter) {\n      // when the widget is loaded into an iframe the search has a parameter called parent which represents the parent url\n      var parentParameter = _utils.getQueryParameter(\"parent\");\n      sysInfoViewerParameter = _utils.getQueryStringParameter(\"sysInfo\", parentParameter);\n    }\n    if (sysInfoViewerParameter) {\n      var playerVersionString = _utils.getQueryStringParameter(\"pv\", sysInfoViewerParameter);\n      var playerVersionDate = _utils.getDateObjectFromPlayerVersionString(playerVersionString);\n      return playerVersionDate >= RC_V2_FIRST_PLAYER_VERSION_DATE;\n    } else {\n      return false;\n    }\n  }\n\n  function reset() {\n    _pingReceived = false;\n     _isCacheRunning = false;\n     _isV2Running = false;\n     _isHttps = true;\n    BASE_CACHE_URL = \"http://localhost:9494/\";\n  }\n\n  return {\n    getErrorMessage: getErrorMessage,\n    getFile: getFile,\n    isRiseCacheRunning: isRiseCacheRunning,\n    isV2Running: isV2Running,\n    isRCV2Player: isRCV2Player,\n    ping: ping,\n    reset: reset\n  };\n\n})();\n\n/* exported version */\nvar version = \"1.1.0\";\n/* exported config */\nif ( typeof angular !== \"undefined\" ) {\n  angular.module( \"risevision.common.i18n.config\", [] )\n    .constant( \"LOCALES_PREFIX\", \"locales/translation_\" )\n    .constant( \"LOCALES_SUFIX\", \".json\" );\n}\n\nconst config = {\n  STORAGE_ENV: \"prod\",\n  COMPONENTS_PATH: \"components/\"\n};\n\n/* global gadgets, _ */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = {};\n\nRiseVision.Video = ( function( window, gadgets ) {\n  \"use strict\";\n\n  var _additionalParams,\n    _mode,\n    _displayId,\n    _isLoading = true,\n    _configDetails = null,\n    _prefs = null,\n    _storage = null,\n    _nonStorage = null,\n    _message = null,\n    _player = null,\n    _viewerPaused = true,\n    _resume = true,\n    _currentFiles = [],\n    _currentPlaylistIndex = null,\n    _errorLog = null,\n    _errorTimer = null,\n    _errorFlag = false,\n    _storageErrorFlag = false,\n    _playerErrorFlag = false,\n    _unavailableFlag = false;\n\n  /*\n   *  Private Methods\n   */\n  function _done() {\n    gadgets.rpc.call( \"\", \"rsevent_done\", null, _prefs.getString( \"id\" ) );\n\n    // Any errors need to be logged before the done event.\n    if ( _errorLog !== null ) {\n      logEvent( _errorLog, true );\n    }\n\n    logEvent( { \"event\": \"done\" }, false );\n  }\n\n  function _ready() {\n    gadgets.rpc.call( \"\", \"rsevent_ready\", null, _prefs.getString( \"id\" ),\n      true, true, true, true, true );\n  }\n\n  function _clearErrorTimer() {\n    clearTimeout( _errorTimer );\n    _errorTimer = null;\n  }\n\n  function _startErrorTimer() {\n    _clearErrorTimer();\n\n    _errorTimer = setTimeout( function() {\n      // notify Viewer widget is done\n      _done();\n    }, 5000 );\n  }\n\n  function _getCurrentFile() {\n    if ( _currentFiles && _currentFiles.length > 0 ) {\n      if ( _mode === \"file\" ) {\n        return _currentFiles[ 0 ];\n      } else if ( _mode === \"folder\" ) {\n        if ( _currentPlaylistIndex ) {\n          // retrieve the currently played file\n          return _currentFiles[ _currentPlaylistIndex ];\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function _resetErrorFlags() {\n    _errorFlag = false;\n    _playerErrorFlag = false;\n    _storageErrorFlag = false;\n    _unavailableFlag = false;\n    _errorLog = null;\n  }\n\n  /*\n   *  Public Methods\n   */\n  function hasStorageError() {\n    return _storageErrorFlag;\n  }\n\n  function hasPlayerError() {\n    return _playerErrorFlag;\n  }\n\n  function showError( message, isStorageError ) {\n    _errorFlag = true;\n    _storageErrorFlag = typeof isStorageError !== \"undefined\";\n\n    _message.show( message );\n\n    _currentPlaylistIndex = null;\n\n    // if Widget is playing right now, run the timer\n    if ( !_viewerPaused ) {\n      _startErrorTimer();\n    }\n\n  }\n\n  function logEvent( params, isError ) {\n    if ( isError ) {\n      _errorLog = params;\n    }\n\n    if ( !params.file_url ) {\n      params.file_url = _getCurrentFile();\n    }\n\n    RiseVision.Common.LoggerUtils.logEvent( getTableName(), params );\n  }\n\n  function onFileInit( urls ) {\n    if ( _mode === \"file\" ) {\n      // urls value will be a string\n      _currentFiles[ 0 ] = urls;\n    } else if ( _mode === \"folder\" ) {\n      // urls value will be an array\n      _currentFiles = urls;\n    }\n\n    _resetErrorFlags();\n\n    _message.hide();\n\n    if ( !_viewerPaused ) {\n      play();\n    }\n  }\n\n  function onFileRefresh( urls ) {\n    if ( _mode === \"file\" ) {\n      // urls value will be a string of one url\n      _currentFiles[ 0 ] = urls;\n    } else if ( _mode === \"folder\" ) {\n      // urls value will be an array of urls\n      _currentFiles = urls;\n    }\n\n    if ( _player ) {\n      _player.update( _currentFiles );\n    }\n\n    // in case refreshed file fixes an error with previous file, ensure flag is removed so playback is attempted again\n    _resetErrorFlags();\n  }\n\n  function onFileUnavailable( message ) {\n    _unavailableFlag = true;\n\n    _message.show( message );\n\n    _currentPlaylistIndex = null;\n\n    // if Widget is playing right now, run the timer\n    if ( !_viewerPaused ) {\n      _startErrorTimer();\n    }\n  }\n\n  function pause() {\n\n    _viewerPaused = true;\n\n    // in case error timer still running (no conditional check on errorFlag, it may have been reset in onFileRefresh)\n    _clearErrorTimer();\n\n    if ( _player ) {\n      if ( !_resume ) {\n        _currentPlaylistIndex = null;\n        _player.reset();\n      } else {\n        _player.pause();\n      }\n    }\n\n  }\n\n  function play() {\n    if ( _isLoading ) {\n      _isLoading = false;\n\n      // Log configuration event.\n      logEvent( {\n        event: \"configuration\",\n        event_details: _configDetails\n      }, false );\n    }\n\n    _viewerPaused = false;\n\n    logEvent( { \"event\": \"play\" }, false );\n\n    if ( _errorFlag ) {\n      _startErrorTimer();\n      return;\n    }\n\n    if ( _unavailableFlag ) {\n      if ( _storage ) {\n        _storage.retry();\n      } else if ( _nonStorage ) {\n        _nonStorage.retry();\n      }\n\n      return;\n    }\n\n    if ( _player ) {\n      // Ensures possible error messaging gets hidden and video gets shown\n      _message.hide();\n\n      _player.play();\n    } else {\n      if ( _currentFiles && _currentFiles.length > 0 ) {\n        _player = new RiseVision.Video.PlayerVJS( _additionalParams, _mode );\n        _player.init( _currentFiles );\n      }\n    }\n\n  }\n\n  function getTableName() {\n    return \"video_v2_events\";\n  }\n\n  function playerEnded() {\n    _currentPlaylistIndex = null;\n\n    _done();\n  }\n\n  function playerReady() {\n    // Ensures loading messaging is hidden and video gets shown\n    _message.hide();\n\n    if ( !_viewerPaused && _player ) {\n      _player.play();\n    }\n  }\n\n  function playerItemChange( index ) {\n    _currentPlaylistIndex = index;\n  }\n\n  function setAdditionalParams( params, mode, displayId ) {\n    var isStorageFile;\n\n    _additionalParams = _.clone( params );\n    _mode = mode;\n    _displayId = displayId;\n    _prefs = new gadgets.Prefs();\n\n    document.getElementById( \"container\" ).style.width = _prefs.getInt( \"rsW\" ) + \"px\";\n    document.getElementById( \"container\" ).style.height = _prefs.getInt( \"rsH\" ) + \"px\";\n\n    _additionalParams.width = _prefs.getInt( \"rsW\" );\n    _additionalParams.height = _prefs.getInt( \"rsH\" );\n\n    if ( _additionalParams.video.hasOwnProperty( \"resume\" ) ) {\n      _resume = _additionalParams.video.resume;\n    }\n\n    _message = new RiseVision.Common.Message( document.getElementById( \"container\" ),\n      document.getElementById( \"messageContainer\" ) );\n\n    if ( RiseVision.Common.Utilities.isLegacy() ) {\n      showError( \"This version of Video Widget is not supported on this version of Rise Player. \" +\n        \"Please use the latest Rise Player version available at https://help.risevision.com/user/create-a-display\" );\n    } else {\n      // show wait message while Storage initializes\n      _message.show( \"Please wait while your video is downloaded.\" );\n\n      if ( _mode === \"file\" ) {\n        isStorageFile = ( Object.keys( _additionalParams.storage ).length !== 0 );\n\n        if ( !isStorageFile ) {\n          _configDetails = \"custom\";\n\n          _nonStorage = new RiseVision.Video.NonStorage( _additionalParams );\n          _nonStorage.init();\n        } else {\n          _configDetails = \"storage file\";\n\n          // create and initialize the Storage file instance\n          _storage = new RiseVision.Video.StorageFile( _additionalParams, _displayId );\n          _storage.init();\n        }\n      } else if ( _mode === \"folder\" ) {\n        _configDetails = \"storage folder\";\n\n        // create and initialize the Storage folder instance\n        _storage = new RiseVision.Video.StorageFolder( _additionalParams, _displayId );\n        _storage.init();\n      }\n    }\n\n    _ready();\n  }\n\n  // An error occurred with Player.\n  function playerError( error ) {\n    var params = {},\n      type = \"MEDIA_ERR_UNKNOWN\",\n      errorMessage = \"Sorry, there was a problem playing the video.\",\n      errorTypes = [\n        \"MEDIA_ERR_CUSTOM\",\n        \"MEDIA_ERR_ABORTED\",\n        \"MEDIA_ERR_NETWORK\",\n        \"MEDIA_ERR_DECODE\",\n        \"MEDIA_ERR_SRC_NOT_SUPPORTED\",\n        \"MEDIA_ERR_ENCRYPTED\"\n      ];\n\n    if ( error ) {\n      type = errorTypes[ error.code ] || type;\n      errorMessage = error.message || errorMessage;\n    }\n\n    params.event = \"player error\";\n    params.event_details = type + \" - \" + errorMessage;\n    _playerErrorFlag = true;\n\n    logEvent( params, true );\n    showError( errorMessage );\n  }\n\n  function stop() {\n    pause();\n  }\n\n  return {\n    \"getTableName\": getTableName,\n    \"hasPlayerError\": hasPlayerError,\n    \"hasStorageError\": hasStorageError,\n    \"logEvent\": logEvent,\n    \"onFileInit\": onFileInit,\n    \"onFileRefresh\": onFileRefresh,\n    \"onFileUnavailable\": onFileUnavailable,\n    \"pause\": pause,\n    \"play\": play,\n    \"setAdditionalParams\": setAdditionalParams,\n    \"showError\": showError,\n    \"playerEnded\": playerEnded,\n    \"playerReady\": playerReady,\n    \"playerError\": playerError,\n    \"playerItemChange\": playerItemChange,\n    \"stop\": stop\n  };\n\n} )( window, gadgets );\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.PlayerUtils = ( function() {\n  \"use strict\";\n\n  /*\n   *  Public  Methods\n   */\n  function getVideoFileType( url ) {\n    var extensions = [ \".mp4\", \".webm\" ],\n      urlLowercase = url.toLowerCase(),\n      type = null,\n      i;\n\n    for ( i = 0; i <= extensions.length; i += 1 ) {\n      if ( urlLowercase.indexOf( extensions[ i ] ) !== -1 ) {\n        type = \"video/\" + extensions[ i ].substr( extensions[ i ].lastIndexOf( \".\" ) + 1 );\n        break;\n      }\n    }\n\n    return type;\n  }\n\n  function getAspectRatio( width, height ) {\n\n    var r;\n\n    function gcd( a, b ) {\n      return ( b == 0 ) ? a : gcd( b, a % b );\n    }\n\n    r = gcd( width, height );\n\n    return width / r + \":\" + height / r;\n  }\n\n  return {\n    \"getAspectRatio\": getAspectRatio,\n    \"getVideoFileType\": getVideoFileType\n  };\n\n} )();\n\n/* global config */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.StorageFile = function( data, displayId ) {\n  \"use strict\";\n\n  var _initialLoad = true,\n    utils = RiseVision.Common.Utilities,\n    riseCache = RiseVision.Common.RiseCache;\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.addEventListener( \"rise-storage-response\", function( e ) {\n      if ( e.detail && e.detail.url ) {\n\n        if ( _initialLoad ) {\n          _initialLoad = false;\n\n          RiseVision.Video.onFileInit( e.detail.url );\n        } else {\n          // check for \"changed\" property\n          if ( e.detail.hasOwnProperty( \"changed\" ) ) {\n            if ( e.detail.changed ) {\n              RiseVision.Video.onFileRefresh( e.detail.url );\n            } else {\n              // in the event of a network failure and recovery, check if the Widget is in a state of storage error\n              if ( RiseVision.Video.hasStorageError() || RiseVision.Video.hasPlayerError() ) {\n                // proceed with refresh logic so the Widget can eventually play video again from a network recovery\n                RiseVision.Video.onFileRefresh( e.detail.url );\n              }\n            }\n          }\n        }\n      }\n    } );\n\n    storage.addEventListener( \"rise-storage-api-error\", function( e ) {\n      var params = {\n        \"event\": \"storage api error\",\n        \"event_details\": \"Response code: \" + e.detail.code + \", message: \" + e.detail.message\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-no-file\", function( e ) {\n      var params = { \"event\": \"storage file not found\", \"event_details\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected video does not exist or has been moved to Trash.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-file-throttled\", function( e ) {\n      var params = { \"event\": \"storage file throttled\", \"file_url\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected video is temporarily unavailable.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-expired\", function() {\n      var params = { \"event\": \"storage subscription expired\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Rise Storage subscription is not active.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-error\", function( e ) {\n      var params = {\n        \"event\": \"storage subscription error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.addEventListener( \"rise-storage-error\", function( e ) {\n      var params = {\n        \"event\": \"rise storage error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\", true );\n    } );\n\n    storage.addEventListener( \"rise-cache-error\", function( e ) {\n      var params = {\n          \"event\": \"rise cache error\",\n          \"event_details\": e.detail.error.message\n        },\n        statusCode = 0,\n        errorMessage = \"\";\n\n      // log the error\n      RiseVision.Video.logEvent( params, true );\n\n      riseCache.isV2Running( function showError( isV2 ) {\n        if ( e.detail.error.message ) {\n          statusCode = +e.detail.error.message.substring( e.detail.error.message.indexOf( \":\" ) + 2 );\n        }\n\n        if ( isV2 ) {\n          errorMessage = riseCache.getErrorMessage( statusCode );\n        // Show a different message if there is a 404 coming from rise cache\n        } else {\n          errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n        }\n\n        // show the error\n        RiseVision.Video.showError( errorMessage );\n      } );\n    } );\n\n    storage.addEventListener( \"rise-cache-not-running\", function( e ) {\n\n      var params = {\n        \"event\": \"rise cache not running\",\n        \"event_details\": \"\"\n      };\n\n      if ( e.detail ) {\n        if ( e.detail.error ) {\n          // storage v1\n          params.event_details = e.detail.error.message;\n        } else if ( e.detail.resp && e.detail.resp.error ) {\n          // storage v2\n          params.event_details = e.detail.resp.error.message;\n        }\n      }\n\n      RiseVision.Video.logEvent( params, true );\n\n      if ( e.detail && e.detail.isPlayerRunning ) {\n        RiseVision.Video.showError( \"Waiting for Rise Cache\", true );\n      }\n    } );\n\n    storage.addEventListener( \"rise-cache-file-unavailable\", function() {\n      RiseVision.Video.onFileUnavailable( \"File is downloading\" );\n    } );\n\n    storage.setAttribute( \"folder\", data.storage.folder );\n    storage.setAttribute( \"fileName\", data.storage.fileName );\n    storage.setAttribute( \"companyId\", data.storage.companyId );\n    storage.setAttribute( \"displayId\", displayId );\n    storage.setAttribute( \"env\", config.STORAGE_ENV );\n\n    storage.go();\n  }\n\n  function retry() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.go();\n  }\n\n  return {\n    \"init\": init,\n    \"retry\": retry\n  };\n};\n\n/* global config, _ */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.StorageFolder = function( data, displayId ) {\n  \"use strict\";\n\n  var _initialLoad = true,\n    _files = [],\n    utils = RiseVision.Common.Utilities,\n    riseCache = RiseVision.Common.RiseCache;\n\n  function _getUrls() {\n    return _.pluck( _files, \"url\" );\n  }\n\n  function _getExistingFile( file ) {\n    return _.find( _files, function( f ) {\n      return file.name === f.name;\n    } );\n  }\n\n  function _deleteFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( existing ) {\n      _files.splice( _files.indexOf( existing ), 1 );\n    }\n  }\n\n  function _changeFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( existing ) {\n      existing.url = file.url;\n    }\n  }\n\n  function _addFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( !existing ) {\n      // extract the actual file name and store in new property on file object\n      file.fileName = file.name.slice( file.name.lastIndexOf( \"/\" ) + 1, file.name.lastIndexOf( \".\" ) ).toLowerCase();\n\n      // insert file to _files list at specific index based on alphabetical order of file name\n      _files.splice( _.sortedIndex( _files, file, \"fileName\" ), 0, file );\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.addEventListener( \"rise-storage-response\", function( e ) {\n      var file = e.detail;\n\n      // Added\n      if ( file.added ) {\n        _addFile( file );\n\n        if ( _initialLoad ) {\n          _initialLoad = false;\n          RiseVision.Video.onFileInit( _getUrls() );\n\n          return;\n        }\n      }\n\n      // Changed or unchanged\n      if ( file.hasOwnProperty( \"changed\" ) ) {\n        if ( file.changed ) {\n          _changeFile( file );\n        } else {\n          // in the event of a network failure and recovery, check if the Widget is in a state of storage error\n          if ( !RiseVision.Video.hasStorageError() && !RiseVision.Video.hasPlayerError() ) {\n            // only proceed with refresh logic below if there's been a storage error, otherwise do nothing\n            // this is so the Widget can eventually play video again from a network recovery\n            return;\n          }\n        }\n      }\n\n      // Deleted\n      if ( file.deleted ) {\n        _deleteFile( file );\n      }\n\n      RiseVision.Video.onFileRefresh( _getUrls() );\n\n    } );\n\n    storage.addEventListener( \"rise-storage-api-error\", function( e ) {\n      var params = {\n        \"event\": \"storage api error\",\n        \"event_details\": \"Response code: \" + e.detail.code + \", message: \" + e.detail.message\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-empty-folder\", function() {\n      var params = { \"event\": \"storage folder empty\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not contain any videos.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-no-folder\", function( e ) {\n      var params = { \"event\": \"storage folder doesn't exist\", \"event_details\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not exist or has been moved to Trash.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-folder-invalid\", function() {\n      var params = { \"event\": \"storage folder format(s) invalid\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not contain any supported video formats.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-expired\", function() {\n      var params = { \"event\": \"storage subscription expired\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Rise Storage subscription is not active.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-error\", function( e ) {\n      var params = {\n        \"event\": \"storage subscription error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.addEventListener( \"rise-storage-error\", function( e ) {\n      var params = {\n        \"event\": \"rise storage error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\", true );\n    } );\n\n    storage.addEventListener( \"rise-cache-error\", function( e ) {\n      var params = {\n          \"event\": \"rise cache error\",\n          \"event_details\": e.detail.error.message\n        },\n        statusCode = 0,\n        errorMessage = \"\";\n\n      RiseVision.Video.logEvent( params, true );\n\n      riseCache.isV2Running( function showError( isV2 ) {\n        if ( e.detail.error.message ) {\n          statusCode = +e.detail.error.message.substring( e.detail.error.message.indexOf( \":\" ) + 2 );\n        }\n\n        if ( isV2 ) {\n          errorMessage = riseCache.getErrorMessage( statusCode );\n        // Show a different message if there is a 404 coming from rise cache\n        } else {\n          errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n        }\n\n        RiseVision.Video.showError( errorMessage );\n      } );\n    } );\n\n    storage.addEventListener( \"rise-cache-not-running\", function( e ) {\n\n      var params = {\n        \"event\": \"rise cache not running\",\n        \"event_details\": \"\"\n      };\n\n      if ( e.detail ) {\n        if ( e.detail.error ) {\n          // storage v1\n          params.event_details = e.detail.error.message;\n        } else if ( e.detail.resp && e.detail.resp.error ) {\n          // storage v2\n          params.event_details = e.detail.resp.error.message;\n        }\n      }\n\n      RiseVision.Video.logEvent( params, true );\n\n      if ( e.detail && e.detail.isPlayerRunning ) {\n        RiseVision.Video.showError( \"Waiting for Rise Cache\", true );\n      }\n    } );\n\n    storage.addEventListener( \"rise-cache-folder-unavailable\", function() {\n      RiseVision.Video.onFileUnavailable( \"Files are downloading\" );\n    } );\n\n    storage.setAttribute( \"fileType\", \"video\" );\n    storage.setAttribute( \"companyId\", data.storage.companyId );\n    storage.setAttribute( \"displayId\", displayId );\n    storage.setAttribute( \"folder\", data.storage.folder );\n    storage.setAttribute( \"env\", config.STORAGE_ENV );\n    storage.go();\n  }\n\n  function retry() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.go();\n  }\n\n  return {\n    \"init\": init,\n    \"retry\": retry\n  };\n};\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.NonStorage = function( data ) {\n  \"use strict\";\n\n  var riseCache = RiseVision.Common.RiseCache,\n    utils = RiseVision.Common.Utilities,\n    // 15 minutes\n    _refreshDuration = 900000,\n    _refreshIntervalId = null,\n    _isLoading = true,\n    _url = \"\";\n\n  function _getFile( omitCacheBuster ) {\n    riseCache.getFile( _url, function( response, error ) {\n      var statusCode = 0,\n        errorMessage;\n\n      if ( !error ) {\n\n        if ( _isLoading ) {\n          _isLoading = false;\n\n          RiseVision.Video.onFileInit( response.url );\n\n          // start the refresh interval\n          _startRefreshInterval();\n\n        } else {\n          RiseVision.Video.onFileRefresh( response.url );\n        }\n\n      } else {\n\n        if ( error.message && error.message === \"File is downloading\" ) {\n\n          RiseVision.Video.onFileUnavailable( error.message );\n\n        } else {\n\n          // error occurred\n          RiseVision.Video.logEvent( {\n            \"event\": \"non-storage error\",\n            \"event_details\": error.message,\n            \"file_url\": response.url\n          }, true );\n\n          riseCache.isV2Running( function showError( isV2 ) {\n            if ( error.message ) {\n              statusCode = +error.message.substring( error.message.indexOf( \":\" ) + 2 );\n            }\n\n            if ( isV2 ) {\n              errorMessage = riseCache.getErrorMessage( statusCode );\n            // Show a different message if there is a 404 coming from rise cache\n            } else {\n              errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n            }\n\n            // show the error\n            RiseVision.Video.showError( errorMessage );\n          } );\n        }\n      }\n    }, omitCacheBuster );\n  }\n\n  function _startRefreshInterval() {\n    if ( _refreshIntervalId === null ) {\n      _refreshIntervalId = setInterval( function() {\n        _getFile( false );\n      }, _refreshDuration );\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    // Handle pre-merge use of \"url\" setting property\n    _url = ( data.url && data.url !== \"\" ) ? data.url : data.selector.url;\n\n    _url = utils.addProtocol( _url );\n\n    _getFile( true );\n  }\n\n  function retry() {\n    _getFile( false );\n  }\n\n  return {\n    \"init\": init,\n    \"retry\": retry\n  };\n};\n\n/* global videojs */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.PlayerVJS = function PlayerVJS( params, mode ) {\n  \"use strict\";\n\n  var _autoPlay = false,\n    _playerInstance = null,\n    _files = null,\n    _fileCount = 0,\n    _utils = RiseVision.Video.PlayerUtils,\n    _updateWaiting = false,\n    _isPaused = false,\n    _pauseTimer,\n    _pause;\n\n  /*\n   *  Private Methods\n   */\n  function _disableFullscreen() {\n    var video = document.getElementById( \"player\" );\n\n    if ( video ) {\n      video.className += video.className ? \" vjs-nofull\" : \"vjs-nofull\";\n    }\n  }\n\n  function _getOptions() {\n    return {\n      controls: params.video.controls,\n      fluid: !params.video.scaleToFit,\n      height: params.height,\n      width: params.width\n    };\n  }\n\n  function _onPause() {\n    if ( !_isPaused ) {\n      clearTimeout( _pauseTimer );\n\n      _pauseTimer = setTimeout( function restart() {\n        if ( _playerInstance.paused() ) {\n          _playerInstance.play();\n        }\n      }, _pause * 1000 );\n    }\n  }\n\n  function _onEnded() {\n    if ( mode === \"file\" ) {\n      RiseVision.Video.playerEnded();\n    } else if ( mode === \"folder\" ) {\n      _fileCount++;\n\n      if ( ( _fileCount >= _playerInstance.playlist().length ) ) {\n        _fileCount = 0;\n        _playerInstance.playlist.currentItem( 0 );\n        RiseVision.Video.playerEnded();\n      } else {\n        _playerInstance.playlist.next();\n      }\n    }\n  }\n\n  function _onError() {\n\n    RiseVision.Video.playerError( _playerInstance.error() );\n  }\n\n  function _onLoadedMetaData() {\n    // Log aspect event\n    RiseVision.Video.logEvent( {\n      event: \"aspect\",\n      event_details: JSON.stringify( {\n        placeholderWidth: params.width,\n        placeholderHeight: params.height,\n        placeholderAspect: _utils.getAspectRatio( params.width, params.height ),\n        videoWidth: _playerInstance.videoWidth(),\n        videoHeight: _playerInstance.videoHeight(),\n        videoAspect: _utils.getAspectRatio( _playerInstance.videoWidth(), _playerInstance.videoHeight() ),\n        scaleToFit: params.video.scaleToFit\n      } ),\n      file_url: _playerInstance.currentSrc()\n    }, false );\n  }\n\n  function _initPlaylist() {\n    var playlist = [],\n      playlistItem,\n      sources,\n      source;\n\n    _files.forEach( function addPlaylistItem( file ) {\n      sources = [];\n      source = {\n        src: file,\n        type: _utils.getVideoFileType( file )\n      };\n\n      sources.push( source );\n      playlistItem = { sources: sources };\n      playlist.push( playlistItem );\n    } );\n\n    _playerInstance.playlist( playlist );\n  }\n\n  function _configureHandlers() {\n    if ( params.video.controls && _pause > 1 ) {\n      _playerInstance.on( \"pause\", _onPause );\n    }\n\n    _playerInstance.on( \"ended\", _onEnded );\n    _playerInstance.on( \"error\", _onError );\n    _playerInstance.on( \"loadedmetadata\", _onLoadedMetaData );\n  }\n\n  function _setVolume() {\n    if ( params.video && ( typeof params.video.volume !== \"undefined\" )\n      && Number.isInteger( params.video.volume ) ) {\n      _playerInstance.volume( params.video.volume / 100 );\n    }\n  }\n\n  function _ready() {\n    if ( _files && _files.length && _files.length > 0 ) {\n      if ( mode === \"file\" ) {\n        _playerInstance.src( { type: _utils.getVideoFileType( _files[ 0 ] ), src: _files[ 0 ] } );\n      } else if ( mode === \"folder\" ) {\n        _initPlaylist();\n      }\n\n      _configureHandlers();\n      _setVolume();\n\n      // notify that player is ready\n      RiseVision.Video.playerReady();\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init( files ) {\n    _files = files;\n    _autoPlay = ( !params.video.controls ) ? true : params.video.autoplay;\n\n    _disableFullscreen();\n\n    // Validate video.pause setting.\n    if ( params.video.pause ) {\n      params.video.pause = ( typeof params.video.pause === \"string\" ) ? parseInt( params.video.pause, 10 ) : params.video.pause;\n      _pause = ( isNaN( params.video.pause ) ) ? 0 : params.video.pause;\n    } else {\n      _pause = 0;\n    }\n\n\n    _playerInstance = videojs( \"player\", _getOptions(), _ready );\n\n    _removeLoadingSpinner();\n\n  }\n\n\n  /*\n    Remove the loading spinner using video js api\n   */\n  function _removeLoadingSpinner() {\n    var loadingSpinnerComponent = _playerInstance.getChild( \"loadingSpinner\" );\n\n    _playerInstance.removeChild( loadingSpinnerComponent );\n  }\n\n  function pause() {\n    _isPaused = true;\n\n    if ( !_playerInstance.paused() ) {\n      _playerInstance.pause();\n    }\n\n    clearTimeout( _pauseTimer );\n  }\n\n  function play() {\n    _isPaused = false;\n\n    if ( _updateWaiting ) {\n      _updateWaiting = false;\n\n      // set a new source\n      if ( _files && _files.length && _files.length > 0 ) {\n        if ( mode === \"file\" ) {\n          _playerInstance.src( { type: _utils.getVideoFileType( _files[ 0 ] ), src: _files[ 0 ] } );\n        } else if ( mode === \"folder\" ) {\n          _initPlaylist();\n        }\n      }\n    }\n\n    if ( _autoPlay ) {\n      _playerInstance.play();\n    }\n  }\n\n  function reset() {\n    pause();\n\n    // if video is at end, a future play call will start video over from beginning automatically\n    if ( _playerInstance.remainingTime() > 0 ) {\n      _playerInstance.currentTime( 0 );\n    }\n  }\n\n  function update( files ) {\n    _files = files;\n    _updateWaiting = true;\n  }\n\n  return {\n    \"init\": init,\n    \"pause\": pause,\n    \"play\": play,\n    \"reset\": reset,\n    \"update\": update\n  };\n};\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.Message = function (mainContainer, messageContainer) {\n  \"use strict\";\n\n  var _active = false;\n\n  function _init() {\n    try {\n      messageContainer.style.height = mainContainer.style.height;\n    } catch (e) {\n      console.warn(\"Can't initialize Message - \", e.message);\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function hide() {\n    if (_active) {\n      // clear content of message container\n      while (messageContainer.firstChild) {\n        messageContainer.removeChild(messageContainer.firstChild);\n      }\n\n      // hide message container\n      messageContainer.style.display = \"none\";\n\n      // show main container\n      mainContainer.style.display = \"block\";\n\n      _active = false;\n    }\n  }\n\n  function show(message) {\n    var fragment = document.createDocumentFragment(),\n      p;\n\n    if (!_active) {\n      // hide main container\n      mainContainer.style.display = \"none\";\n\n      messageContainer.style.display = \"block\";\n\n      // create message element\n      p = document.createElement(\"p\");\n      p.innerHTML = message;\n      p.setAttribute(\"class\", \"message\");\n\n      fragment.appendChild(p);\n      messageContainer.appendChild(fragment);\n\n      _active = true;\n    } else {\n      // message already being shown, update message text\n      p = messageContainer.querySelector(\".message\");\n      p.innerHTML = message;\n    }\n  }\n\n  _init();\n\n  return {\n    \"hide\": hide,\n    \"show\": show\n  };\n};\n\n/* global gadgets, RiseVision, config, version */\n\n( function( window, gadgets ) {\n  \"use strict\";\n\n  var prefs = new gadgets.Prefs(),\n    id = prefs.getString( \"id\" );\n\n  // Disable context menu (right click menu)\n  window.oncontextmenu = function() {\n    return false;\n  };\n\n  function configure( names, values ) {\n    var additionalParams = null,\n      mode = \"\",\n      companyId = \"\",\n      displayId = \"\";\n\n    if ( Array.isArray( names ) && names.length > 0 && Array.isArray( values ) && values.length > 0 ) {\n      if ( names[ 0 ] === \"companyId\" ) {\n        companyId = values[ 0 ];\n      }\n\n      if ( names[ 1 ] === \"displayId\" ) {\n        if ( values[ 1 ] ) {\n          displayId = values[ 1 ];\n        } else {\n          displayId = \"preview\";\n        }\n      }\n\n      RiseVision.Common.LoggerUtils.setIds( companyId, displayId );\n      RiseVision.Common.LoggerUtils.setVersion( version );\n\n      if ( names[ 2 ] === \"additionalParams\" ) {\n        additionalParams = JSON.parse( values[ 2 ] );\n\n        if ( Object.keys( additionalParams.storage ).length !== 0 ) {\n          // storage file or folder selected\n          if ( !additionalParams.storage.fileName ) {\n            // folder was selected\n            mode = \"folder\";\n            RiseVision.Common.Utilities.loadScript( config.COMPONENTS_PATH + \"videojs-playlist/dist/videojs-playlist.min.js\" );\n          } else {\n            // file was selected\n            mode = \"file\";\n          }\n        } else {\n          // non-storage file was selected\n          mode = \"file\";\n        }\n\n        RiseVision.Video.setAdditionalParams( additionalParams, mode, displayId );\n      }\n    }\n  }\n\n  function play() {\n    RiseVision.Video.play();\n  }\n\n  function pause() {\n    RiseVision.Video.pause();\n  }\n\n  function stop() {\n    RiseVision.Video.stop();\n  }\n\n  function init() {\n    if ( id && id !== \"\" ) {\n      gadgets.rpc.register( \"rscmd_play_\" + id, play );\n      gadgets.rpc.register( \"rscmd_pause_\" + id, pause );\n      gadgets.rpc.register( \"rscmd_stop_\" + id, stop );\n\n      gadgets.rpc.register( \"rsparam_set_\" + id, configure );\n      gadgets.rpc.call( \"\", \"rsparam_get\", null, id, [ \"companyId\", \"displayId\", \"additionalParams\" ] );\n    }\n  }\n\n  // check which version of Rise Cache is running and dynamically add rise-storage dependencies\n  RiseVision.Common.RiseCache.isRCV2Player( function( isV2 ) {\n    var fragment = document.createDocumentFragment(),\n      link = document.createElement( \"link\" ),\n      webcomponents = document.createElement( \"script\" ),\n      href = config.COMPONENTS_PATH + ( ( isV2 ) ? \"rise-storage-v2\" : \"rise-storage\" ) + \"/rise-storage.html\",\n      storage = document.createElement( \"rise-storage\" ),\n      storageReady = false,\n      polymerReady = false;\n\n    function onPolymerReady() {\n      window.removeEventListener( \"WebComponentsReady\", onPolymerReady );\n      polymerReady = true;\n\n      if ( storageReady && polymerReady ) {\n        init();\n      }\n    }\n\n    function onStorageReady() {\n      storage.removeEventListener( \"rise-storage-ready\", onStorageReady );\n      storageReady = true;\n\n      if ( storageReady && polymerReady ) {\n        init();\n      }\n    }\n\n    webcomponents.src = config.COMPONENTS_PATH + \"webcomponentsjs/webcomponents-lite.min.js\";\n    window.addEventListener( \"WebComponentsReady\", onPolymerReady );\n\n    // add the webcomponents polyfill source to the document head\n    document.getElementsByTagName( \"head\" )[ 0 ].appendChild( webcomponents );\n\n    link.setAttribute( \"rel\", \"import\" );\n    link.setAttribute( \"href\", href );\n\n    // add the rise-storage <link> element to document head\n    document.getElementsByTagName( \"head\" )[ 0 ].appendChild( link );\n\n    storage.setAttribute( \"id\", \"videoStorage\" );\n    storage.setAttribute( \"refresh\", 5 );\n\n    if ( isV2 ) {\n      storage.setAttribute( \"usage\", \"widget\" );\n    }\n\n    storage.addEventListener( \"rise-storage-ready\", onStorageReady );\n    fragment.appendChild( storage );\n\n    // add the <rise-storage> element to the body\n    document.body.appendChild( fragment );\n  } );\n\n} )( window, gadgets );\n\n\n\nvar _gaq = _gaq || [];\n\n_gaq.push(['_setAccount', 'UA-57092159-2']);\n_gaq.push(['_trackPageview']);\n\n(function() {\n  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n})();\n"]}