var WIDGET_COMMON_CONFIG={AUTH_PATH_URL:"v1/widget/auth",LOGGER_CLIENT_ID:"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com",LOGGER_CLIENT_SECRET:"nlZyrcPLg6oEwO9f9Wfn29Wh",LOGGER_REFRESH_TOKEN:"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT",STORE_URL:"https://store-dot-rvaserver2.appspot.com/"},RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(){"use strict";function e(e,t){var o=null;e.event?(o=e,o.file_url&&(o.file_format=n(o.file_url)),o.company_id=c,o.display_id=l,u&&(o.version=u),t(o)):t(o)}function t(){var e=new Date,t=e.getUTCFullYear(),n=e.getUTCMonth()+1,o=e.getUTCDate();return 10>n&&(n="0"+n),10>o&&(o="0"+o),""+t+n+o}function n(e){var t,n=/[?#&]/;return e&&"string"==typeof e?(t=e.substr(e.lastIndexOf(".")+1),n.test(t)&&(t=t.substr(0,-1!==t.indexOf("?")?t.indexOf("?"):t.length),t=t.substr(0,-1!==t.indexOf("#")?t.indexOf("#"):t.length),t=t.substr(0,-1!==t.indexOf("&")?t.indexOf("&"):t.length)),t.toLowerCase()):null}function o(e){var n={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,templateSuffix:t(),rows:[{insertId:""}]},o=JSON.parse(JSON.stringify(n));return o.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),o.rows[0].json=JSON.parse(JSON.stringify(e)),o.rows[0].json.ts=(new Date).toISOString(),o}function i(t,n){e(n,function(e){null!==e&&RiseVision.Common.Logger.log(t,e)})}function r(e,n){try{top.postToPlayer({message:"widget-log",table:e,params:JSON.stringify(n),suffix:t()})}catch(o){console.log("widget-common.logEventToPlayer",o)}}function s(e,t){c=e,l=t}function a(e){u=e}var l="",c="",u=null;return{getInsertData:o,getFileFormat:n,logEvent:i,logEventToPlayer:r,setIds:s,setVersion:a}}(),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-c<358e4?e({}):(t.open("POST",i,!0),t.onloadend=function(){var n={};try{n=JSON.parse(t.response)}catch(o){console.warn("Can't refresh logger token - ",o.message)}e({token:n.access_token,refreshedAt:new Date})},t.send(),void 0)}function n(e){return s&&l===e}function o(o,i){function g(t){var n,s,a=new XMLHttpRequest;s=r.replace("TABLE_ID",o),c=t.refreshedAt||c,u=t.token||u,n=e.getInsertData(i),a.open("POST",s,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+u),i.cb&&"function"==typeof i.cb&&(a.onloadend=function(){i.cb(a.response)}),a.send(JSON.stringify(n))}if(!(!o||!i||i.hasOwnProperty("event")&&!i.event||i.hasOwnProperty("event")&&n(i.event))&&i.display_id&&"preview"!==i.display_id&&"display_id"!==i.display_id&&"displayId"!==i.display_id){try{if(top.postToPlayer&&top.enableWidgetLogging)return e.logEventToPlayer(o,i)}catch(f){console.log("widget-common: logger",f)}return s=!0,l=i.event,setTimeout(function(){s=!1},a),t(g)}}var i="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",r="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",s=!1,a=1e3,l="",c=0,u="";return{log:o}}(RiseVision.Common.LoggerUtils);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Utilities=function(){function e(e,t){var n="font-family: "+decodeURIComponent(t.font.family).replace(/'/g,"")+"; ",o="color: "+(t.color?t.color:t.forecolor)+"; ",i="font-size: "+(-1===t.size.indexOf("px")?t.size+"px; ":t.size+"; "),r="font-weight: "+(t.bold?"bold":"normal")+"; ",s="font-style: "+(t.italic?"italic":"normal")+"; ",a="text-decoration: "+(t.underline?"underline":"none")+"; ",l="background-color: "+(t.highlightColor?t.highlightColor:t.backcolor)+";";return"."+e+" {"+n+o+i+r+s+a+l+"}"}function t(e){for(var t=document.createElement("style"),n=0,o=e.length;o>n;n++)t.appendChild(document.createTextNode(e[n]));document.head.appendChild(t)}function n(n,r){function s(){r&&"function"==typeof r&&r()}function a(){s()}var l=null,c=[],u=[],g=[];if(!n||0===n.length)return s(),void 0;n.forEach(function(n){n.class&&n.fontStyle&&t([e(n.class,n.fontStyle)])});for(var f=0;f<n.length;f++)n[f].fontStyle&&n[f].fontStyle.font.type&&"google"===n[f].fontStyle.font.type&&(l=n[f].fontStyle.font.family.split(",")[0],l=l.replace(/'/g,""),c.push(l));for(f=0;f<n.length;f++)n[f].fontStyle&&n[f].fontStyle.font.type&&"custom"===n[f].fontStyle.font.type&&(u.push(decodeURIComponent(n[f].fontStyle.font.family).replace(/'/g,"")),g.push(n[f].fontStyle.font.url.replace(/'/g,"\\'")));if(0===c.length&&0===u.length)s();else{for(var d=0;d<u.length;d+=1)o(u[d],g[d]);c.length>0?i(c,a):s()}}function o(e,t,n){var o=null,i="font-family: "+e+"; src: url('"+t+"');";n=n||document,o=n.styleSheets[0],null!==o&&o.addRule("@font-face",i)}function i(e,t){WebFont.load({google:{families:e},active:function(){t&&"function"==typeof t&&t()},inactive:function(){t&&"function"==typeof t&&t()},timeout:2e3})}function r(e){var t=document.createElement("script");t.src=e,document.body.appendChild(t)}function s(e){for(var t=e.length,n=[],o=0;t>o;o++)n[o]=new Image,n[o].src=e[o]}function a(e){return l(e,window.location.search.substring(1))}function l(e,t){for(var n,o=t.split("&"),i=0;i<o.length;i++)if(n=o[i].split("="),n[0]==e)return decodeURIComponent(n[1]);return""}function c(e){var t=/(\d{4})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})/,n=t.exec(e);return n?new Date(+n[1],+n[2]-1,+n[3],+n[4],+n[5]):void 0}function u(e){var t="";switch(e){case 404:t="The file does not exist or cannot be accessed.";break;case 507:t="There is not enough disk space to save the file on Rise Cache.";break;default:t="There was a problem retrieving the file from Rise Cache."}return t}function g(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent}function f(e,t){var n=new XMLHttpRequest;if(e&&t&&"function"==typeof t){n.open("HEAD",e+"?cb="+(new Date).getTime(),!1);try{n.send(),t(n.status>=200&&n.status<304)}catch(o){t(!1)}}}function d(){var e=25,t=navigator.userAgent.match(/Chrome\/(\S+)/),n=t?t[1]:0;return n&&(n=parseInt(n.substring(0,n.indexOf("."))),e>=n)?!0:!1}function m(e,t){return/^(?:f|ht)tps?\:\/\//.test(e)||(e=(t?"https://":"http://")+e),e}return{addProtocol:m,getQueryParameter:a,getQueryStringParameter:l,getFontCssStyle:e,addCSSRules:t,loadFonts:n,loadCustomFont:o,loadGoogleFonts:i,loadScript:r,preloadImages:s,getRiseCacheErrorMessage:u,unescapeHTML:g,hasInternetConnection:f,isLegacy:d,getDateObjectFromPlayerVersionString:c}}();var config={STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json");var RiseVision=RiseVision||{};RiseVision.WebPage={},RiseVision.WebPage=function(e,t){"use strict";function n(){t.rpc.call("","rsevent_ready",null,v.getString("id"),!0,!0,!0,!0,!1)}function o(t){var n=e.querySelector(".blocker");n.style.display=b.interactivity.interactive?"none":"block",t.setAttribute("scrolling",b.interactivity.interactive&&b.interactivity.scrollbars?"yes":"no")}function i(){var t=e.getElementById("container"),n=v.getInt("rsH")/v.getInt("rsW")*100;t&&(0!==R&&(n+=R/v.getInt("rsW")*100),t.setAttribute("style","padding-bottom:"+n+"%"))}function r(e){var t=parseFloat(b.zoom),n="",o="";o="-ms-zoom:"+t+";-moz-transform: scale("+t+");-moz-transform-origin: 0 0;-o-transform: scale("+t+");-o-transform-origin: 0 0;-webkit-transform: scale("+t+");-webkit-transform-origin: 0 0;transform: scale("+t+");transform-origin: 0 0;",n=e.getAttribute("style"),o+="width: "+(1/t*100+I)+"%;height: "+1/t*100+"%;",n&&(o=n+o),e.setAttribute("style",o)}function s(e){var t="",n="",o=0;b.region&&b.region.showRegion&&"region"===b.region.showRegion&&(b.region.horizontal>0&&(o=b.region.horizontal),b.region.vertical>0&&(R=b.region.vertical),(0!==o||0!==R)&&(I=100*o/v.getInt("rsW"),t=e.getAttribute("style"),n="margin: -"+R+"px 0 0 -"+o+"px;",t&&(n=t+n),e.setAttribute("style",n)))}function a(){_=setInterval(function(){C.hasInternetConnection("img/transparent.png",function(e){e&&c()})},b.refresh)}function l(){var t=e.createElement("iframe"),n=e.getElementById("container");return t.className="webpage-frame",t.style.visibility="hidden",t.setAttribute("frameborder","0"),t.setAttribute("allowTransparency","true"),t.setAttribute("sandbox","allow-forms allow-same-origin allow-scripts"),o(t),s(t),r(t),i(),t.onload=function(){this.onload=null,this.style.visibility="visible",E=!1,b.refresh>0&&null===_&&a(),e.querySelectorAll(".webpage-frame").length>1&&n.removeChild(e.querySelector(".webpage-frame"))},t}function c(){var t=e.getElementById("container"),n=e.createDocumentFragment(),o=l();o.setAttribute("src",w),n.appendChild(o),t.appendChild(n)}function u(){var t=e.getElementById("container"),n=e.querySelector(".webpage-frame");b.refresh>0&&(clearInterval(_),_=null),n&&t.removeChild(n)}function g(){O=new RiseVision.Common.Message(e.getElementById("container"),e.getElementById("messageContainer")),e.getElementById("messageContainer").style.height=v.getInt("rsH")+"px",w=b.url,-1===w.indexOf("://")&&(w="http://"+w),n()}function f(){return"webpage_events"}function d(e){RiseVision.Common.LoggerUtils.logEvent(f(),e)}function m(){b.unload&&u()}function p(){d({event:"play",url:w}),(E||b.unload)&&c()}function y(){m()}function h(e){b=JSON.parse(JSON.stringify(e)),g()}var v=new t.Prefs,C=RiseVision.Common.Utilities,b=null,w="",R=0,_=null,E=!0,I=0,O=null;return{getTableName:f,logEvent:d,setAdditionalParams:h,pause:m,play:p,stop:y}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function n(){try{t.style.height=e.style.height}catch(n){console.warn("Can't initialize Message - ",n.message)}}function o(){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.display="block",r=!1}}function i(n){var o,i=document.createDocumentFragment();r?(o=t.querySelector(".message"),o.innerHTML=n):(e.style.display="none",t.style.display="block",o=document.createElement("p"),o.innerHTML=n,o.setAttribute("class","message"),i.appendChild(o),t.appendChild(i),r=!0)}var r=!1;return n(),{hide:o,show:i}},function(e,t,n){"use strict";function o(e,t){var n,o="",i="";Array.isArray(e)&&e.length>0&&Array.isArray(t)&&t.length>0&&("companyId"===e[0]&&(o=t[0]),"displayId"===e[1]&&(i=t[1]?t[1]:"preview"),RiseVision.Common.LoggerUtils.setIds(o,i),"additionalParams"===e[2]&&(n=JSON.parse(t[2]),RiseVision.WebPage.setAdditionalParams(n)))}function i(){RiseVision.WebPage.play()}function r(){RiseVision.WebPage.pause()}function s(){RiseVision.WebPage.stop()}var a=(new n.Prefs).getString("id");e.oncontextmenu=function(){return!1},t.body.onmousedown=function(){return!1},a&&""!==a&&(n.rpc.register("rscmd_play_"+a,i),n.rpc.register("rscmd_pause_"+a,r),n.rpc.register("rscmd_stop_"+a,s),n.rpc.register("rsparam_set_"+a,o),n.rpc.call("","rsparam_get",null,a,["companyId","displayId","additionalParams"]))}(window,document,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-6"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiV0lER0VUX0NPTU1PTl9DT05GSUciLCJBVVRIX1BBVEhfVVJMIiwiTE9HR0VSX0NMSUVOVF9JRCIsIkxPR0dFUl9DTElFTlRfU0VDUkVUIiwiTE9HR0VSX1JFRlJFU0hfVE9LRU4iLCJTVE9SRV9VUkwiLCJSaXNlVmlzaW9uIiwiQ29tbW9uIiwiTG9nZ2VyVXRpbHMiLCJnZXRFdmVudFBhcmFtcyIsInBhcmFtcyIsImNiIiwianNvbiIsImV2ZW50IiwiZmlsZV91cmwiLCJmaWxlX2Zvcm1hdCIsImdldEZpbGVGb3JtYXQiLCJjb21wYW55X2lkIiwiY29tcGFueUlkIiwiZGlzcGxheV9pZCIsImRpc3BsYXlJZCIsInZlcnNpb24iLCJnZXRTdWZmaXgiLCJkYXRlIiwiRGF0ZSIsInllYXIiLCJnZXRVVENGdWxsWWVhciIsIm1vbnRoIiwiZ2V0VVRDTW9udGgiLCJkYXkiLCJnZXRVVENEYXRlIiwidXJsIiwic3RyIiwiaGFzUGFyYW1zIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJ0ZXN0IiwiaW5kZXhPZiIsImxlbmd0aCIsInRvTG93ZXJDYXNlIiwiZ2V0SW5zZXJ0RGF0YSIsIkJBU0VfSU5TRVJUX1NDSEVNQSIsImtpbmQiLCJza2lwSW52YWxpZFJvd3MiLCJpZ25vcmVVbmtub3duVmFsdWVzIiwidGVtcGxhdGVTdWZmaXgiLCJyb3dzIiwiaW5zZXJ0SWQiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwidG9VcHBlckNhc2UiLCJ0cyIsInRvSVNPU3RyaW5nIiwibG9nRXZlbnQiLCJ0YWJsZSIsIkxvZ2dlciIsImxvZyIsImxvZ0V2ZW50VG9QbGF5ZXIiLCJ0b3AiLCJwb3N0VG9QbGF5ZXIiLCJtZXNzYWdlIiwic3VmZml4IiwiZXJyIiwiY29uc29sZSIsInNldElkcyIsImNvbXBhbnkiLCJkaXNwbGF5Iiwic2V0VmVyc2lvbiIsInZhbHVlIiwidXRpbHMiLCJyZWZyZXNoVG9rZW4iLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInJlZnJlc2hEYXRlIiwib3BlbiIsIlJFRlJFU0hfVVJMIiwib25sb2FkZW5kIiwicmVzcCIsInJlc3BvbnNlIiwiZSIsIndhcm4iLCJ0b2tlbiIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hlZEF0Iiwic2VuZCIsImlzVGhyb3R0bGVkIiwidGhyb3R0bGUiLCJsYXN0RXZlbnQiLCJ0YWJsZU5hbWUiLCJpbnNlcnRXaXRoVG9rZW4iLCJyZWZyZXNoRGF0YSIsImluc2VydERhdGEiLCJzZXJ2aWNlVXJsIiwicmVwbGFjZSIsInNldFJlcXVlc3RIZWFkZXIiLCJoYXNPd25Qcm9wZXJ0eSIsImVuYWJsZVdpZGdldExvZ2dpbmciLCJzZXRUaW1lb3V0IiwidGhyb3R0bGVEZWxheSIsIlV0aWxpdGllcyIsImdldEZvbnRDc3NTdHlsZSIsImNsYXNzTmFtZSIsImZvbnRPYmoiLCJmYW1pbHkiLCJkZWNvZGVVUklDb21wb25lbnQiLCJmb250IiwiY29sb3IiLCJmb3JlY29sb3IiLCJzaXplIiwid2VpZ2h0IiwiYm9sZCIsIml0YWxpYyIsInVuZGVybGluZSIsImhpZ2hsaWdodCIsImhpZ2hsaWdodENvbG9yIiwiYmFja2NvbG9yIiwiYWRkQ1NTUnVsZXMiLCJydWxlcyIsInN0eWxlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaSIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJoZWFkIiwibG9hZEZvbnRzIiwic2V0dGluZ3MiLCJjYWxsYmFjayIsIm9uR29vZ2xlRm9udHNMb2FkZWQiLCJmYW1pbGllcyIsImdvb2dsZUZhbWlsaWVzIiwiY3VzdG9tRmFtaWxpZXMiLCJjdXN0b21VcmxzIiwiZm9yRWFjaCIsIml0ZW0iLCJjbGFzcyIsImZvbnRTdHlsZSIsInR5cGUiLCJzcGxpdCIsInB1c2giLCJqIiwibG9hZEN1c3RvbUZvbnQiLCJsb2FkR29vZ2xlRm9udHMiLCJjb250ZW50RG9jIiwic2hlZXQiLCJydWxlIiwic3R5bGVTaGVldHMiLCJhZGRSdWxlIiwiV2ViRm9udCIsImxvYWQiLCJnb29nbGUiLCJhY3RpdmUiLCJpbmFjdGl2ZSIsInRpbWVvdXQiLCJsb2FkU2NyaXB0Iiwic3JjIiwic2NyaXB0IiwiYm9keSIsInByZWxvYWRJbWFnZXMiLCJ1cmxzIiwiaW1hZ2VzIiwiSW1hZ2UiLCJnZXRRdWVyeVBhcmFtZXRlciIsInBhcmFtIiwiZ2V0UXVlcnlTdHJpbmdQYXJhbWV0ZXIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInF1ZXJ5IiwicGFpciIsInZhcnMiLCJnZXREYXRlT2JqZWN0RnJvbVBsYXllclZlcnNpb25TdHJpbmciLCJwbGF5ZXJWZXJzaW9uIiwicmVnZ2llIiwiZGF0ZUFycmF5IiwiZXhlYyIsImdldFJpc2VDYWNoZUVycm9yTWVzc2FnZSIsInN0YXR1c0NvZGUiLCJlcnJvck1lc3NhZ2UiLCJ1bmVzY2FwZUhUTUwiLCJodG1sIiwiZGl2IiwiaW5uZXJIVE1MIiwidGV4dENvbnRlbnQiLCJoYXNJbnRlcm5ldENvbm5lY3Rpb24iLCJmaWxlUGF0aCIsImdldFRpbWUiLCJzdGF0dXMiLCJpc0xlZ2FjeSIsImxlZ2FjeVZlcnNpb24iLCJtYXRjaCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInBhcnNlSW50IiwiYWRkUHJvdG9jb2wiLCJzZWN1cmUiLCJjb25maWciLCJTVE9SQUdFX0VOViIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsIldlYlBhZ2UiLCJnYWRnZXRzIiwiX3JlYWR5IiwicnBjIiwiY2FsbCIsIl9wcmVmcyIsImdldFN0cmluZyIsIl9zZXRJbnRlcmFjdGl2aXR5IiwiZnJhbWUiLCJibG9ja2VyIiwicXVlcnlTZWxlY3RvciIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaW50ZXJhY3Rpdml0eSIsInNldEF0dHJpYnV0ZSIsImludGVyYWN0aXZlIiwic2Nyb2xsYmFycyIsIl9zZXRBc3BlY3RSYXRpbyIsImNvbnRhaW5lciIsImdldEVsZW1lbnRCeUlkIiwiYXNwZWN0UmF0aW8iLCJnZXRJbnQiLCJfdmVydGljYWwiLCJfc2V0Wm9vbSIsInpvb20iLCJwYXJzZUZsb2F0IiwiY3VycmVudFN0eWxlIiwiem9vbVN0eWxlIiwiZ2V0QXR0cmlidXRlIiwiX3dpZHRoT2Zmc2V0IiwiX3NldFJlZ2lvbiIsIm1hcmdpblN0eWxlIiwiaG9yaXpvbnRhbCIsInJlZ2lvbiIsInNob3dSZWdpb24iLCJ2ZXJ0aWNhbCIsIl9zdGFydFJlZnJlc2hJbnRlcnZhbCIsIl9pbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJfdXRpbHMiLCJoYXNJbnRlcm5ldCIsIl9sb2FkRnJhbWUiLCJyZWZyZXNoIiwiX2dldEZyYW1lRWxlbWVudCIsInZpc2liaWxpdHkiLCJvbmxvYWQiLCJ0aGlzIiwiX2luaXRpYWxMb2FkIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbW92ZUNoaWxkIiwiZnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiX3VybCIsIl91bmxvYWRGcmFtZSIsImNsZWFySW50ZXJ2YWwiLCJfaW5pdCIsIl9tZXNzYWdlIiwiTWVzc2FnZSIsImhlaWdodCIsImdldFRhYmxlTmFtZSIsInBhdXNlIiwidW5sb2FkIiwicGxheSIsInN0b3AiLCJzZXRBZGRpdGlvbmFsUGFyYW1zIiwiYWRkaXRpb25hbFBhcmFtcyIsIlByZWZzIiwibWFpbkNvbnRhaW5lciIsIm1lc3NhZ2VDb250YWluZXIiLCJoaWRlIiwiX2FjdGl2ZSIsImZpcnN0Q2hpbGQiLCJzaG93IiwicCIsImNvbmZpZ3VyZSIsIm5hbWVzIiwidmFsdWVzIiwiQXJyYXkiLCJpc0FycmF5IiwiaWQiLCJvbmNvbnRleHRtZW51Iiwib25tb3VzZWRvd24iLCJyZWdpc3RlciIsIl9nYXEiLCJnYSIsImFzeW5jIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSx1QkFDRkMsY0FBZSxp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LGNBQWdCSCxFQUFJaEIsR0FDMUM3RCxFQUFRRSxJQUFJOEUsU0FBVSxlQUFpQkgsRUFBSUwsR0FDM0N4RSxFQUFRRSxJQUFJQyxLQUFNLEdBQUksY0FBZSxLQUFNMEUsR0FBTSxZQUFhLFlBQWEsdUJBRzFFbkgsT0FBUTlDLFNBQVVvRixRQUt2QixJQUFJaUYsTUFBT0EsUUFFWEEsTUFBS2pKLE1BQU0sY0FBZSxrQkFDMUJpSixLQUFLakosTUFBTSxtQkFFWCxXQUNFLEdBQUlrSixHQUFLdEssU0FBU0MsY0FBYyxTQUFXcUssR0FBR3BKLEtBQU8sa0JBQW1Cb0osRUFBR0MsT0FBUSxFQUNuRkQsRUFBR2xJLEtBQU8sVUFBWXBDLFNBQVMrQyxTQUFTeUgsU0FBVyxjQUFnQixjQUFnQiw2QkFDbkYsSUFBSUMsR0FBSXpLLFNBQVMwSyxxQkFBcUIsVUFBVSxFQUFJRCxHQUFFRSxXQUFXQyxhQUFhTixFQUFJRyIsImZpbGUiOiJqcy93aWRnZXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXhwb3J0ZWQgV0lER0VUX0NPTU1PTl9DT05GSUcgKi9cbnZhciBXSURHRVRfQ09NTU9OX0NPTkZJRyA9IHtcbiAgQVVUSF9QQVRIX1VSTDogXCJ2MS93aWRnZXQvYXV0aFwiLFxuICBMT0dHRVJfQ0xJRU5UX0lEOiBcIjEwODg1MjcxNDcxMDktNnExbzJ2dGlobjM0MjkycGp0NGNraG1oY2swcmswbzcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb21cIixcbiAgTE9HR0VSX0NMSUVOVF9TRUNSRVQ6IFwibmxaeXJjUExnNm9Fd085ZjlXZm4yOVdoXCIsXG4gIExPR0dFUl9SRUZSRVNIX1RPS0VOOiBcIjEveHp0NGt3ekUxSDdXOVZuS0I4Y0FhQ3g2emI0RXM0bktFb3FhWUhkVEQxNUlnT3JKRHRkdW42eks2WGlBVENLVFwiLFxuICBTVE9SRV9VUkw6IFwiaHR0cHM6Ly9zdG9yZS1kb3QtcnZhc2VydmVyMi5hcHBzcG90LmNvbS9cIlxufTtcbi8qIGdsb2JhbCBXSURHRVRfQ09NTU9OX0NPTkZJRyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5Mb2dnZXJVdGlscyA9IChmdW5jdGlvbigpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgIHZhciBkaXNwbGF5SWQgPSBcIlwiLFxuICAgICBjb21wYW55SWQgPSBcIlwiLFxuICAgICB2ZXJzaW9uID0gbnVsbDtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuXG4gIC8qIFJldHJpZXZlIHBhcmFtZXRlcnMgdG8gcGFzcyB0byB0aGUgZXZlbnQgbG9nZ2VyLiAqL1xuICBmdW5jdGlvbiBnZXRFdmVudFBhcmFtcyhwYXJhbXMsIGNiKSB7XG4gICAgdmFyIGpzb24gPSBudWxsO1xuXG4gICAgLy8gZXZlbnQgaXMgcmVxdWlyZWQuXG4gICAgaWYgKHBhcmFtcy5ldmVudCkge1xuICAgICAganNvbiA9IHBhcmFtcztcblxuICAgICAgaWYgKGpzb24uZmlsZV91cmwpIHtcbiAgICAgICAganNvbi5maWxlX2Zvcm1hdCA9IGdldEZpbGVGb3JtYXQoanNvbi5maWxlX3VybCk7XG4gICAgICB9XG5cbiAgICAgIGpzb24uY29tcGFueV9pZCA9IGNvbXBhbnlJZDtcbiAgICAgIGpzb24uZGlzcGxheV9pZCA9IGRpc3BsYXlJZDtcblxuICAgICAgaWYgKHZlcnNpb24pIHtcbiAgICAgICAganNvbi52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgIH1cblxuICAgICAgY2IoanNvbik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY2IoanNvbik7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHN1ZmZpeCBmb3IgQlEgdGFibGUgbmFtZS5cbiAgZnVuY3Rpb24gZ2V0U3VmZml4KCkge1xuICAgIHZhciBkYXRlID0gbmV3IERhdGUoKSxcbiAgICAgIHllYXIgPSBkYXRlLmdldFVUQ0Z1bGxZZWFyKCksXG4gICAgICBtb250aCA9IGRhdGUuZ2V0VVRDTW9udGgoKSArIDEsXG4gICAgICBkYXkgPSBkYXRlLmdldFVUQ0RhdGUoKTtcblxuICAgIGlmIChtb250aCA8IDEwKSB7XG4gICAgICBtb250aCA9IFwiMFwiICsgbW9udGg7XG4gICAgfVxuXG4gICAgaWYgKGRheSA8IDEwKSB7XG4gICAgICBkYXkgPSBcIjBcIiArIGRheTtcbiAgICB9XG5cbiAgICByZXR1cm4gXCJcIiArIHllYXIgKyBtb250aCArIGRheTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gZ2V0RmlsZUZvcm1hdCh1cmwpIHtcbiAgICB2YXIgaGFzUGFyYW1zID0gL1s/IyZdLyxcbiAgICAgIHN0cjtcblxuICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHN0ciA9IHVybC5zdWJzdHIodXJsLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuXG4gICAgLy8gZG9uJ3QgaW5jbHVkZSBhbnkgcGFyYW1zIGFmdGVyIHRoZSBmaWxlbmFtZVxuICAgIGlmIChoYXNQYXJhbXMudGVzdChzdHIpKSB7XG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAgLChzdHIuaW5kZXhPZihcIj9cIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiP1wiKSA6IHN0ci5sZW5ndGgpO1xuXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAsIChzdHIuaW5kZXhPZihcIiNcIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiI1wiKSA6IHN0ci5sZW5ndGgpO1xuXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAsIChzdHIuaW5kZXhPZihcIiZcIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiJlwiKSA6IHN0ci5sZW5ndGgpO1xuICAgIH1cblxuICAgIHJldHVybiBzdHIudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEluc2VydERhdGEocGFyYW1zKSB7XG4gICAgdmFyIEJBU0VfSU5TRVJUX1NDSEVNQSA9IHtcbiAgICAgIFwia2luZFwiOiBcImJpZ3F1ZXJ5I3RhYmxlRGF0YUluc2VydEFsbFJlcXVlc3RcIixcbiAgICAgIFwic2tpcEludmFsaWRSb3dzXCI6IGZhbHNlLFxuICAgICAgXCJpZ25vcmVVbmtub3duVmFsdWVzXCI6IGZhbHNlLFxuICAgICAgXCJ0ZW1wbGF0ZVN1ZmZpeFwiOiBnZXRTdWZmaXgoKSxcbiAgICAgIFwicm93c1wiOiBbe1xuICAgICAgICBcImluc2VydElkXCI6IFwiXCJcbiAgICAgIH1dXG4gICAgfSxcbiAgICBkYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShCQVNFX0lOU0VSVF9TQ0hFTUEpKTtcblxuICAgIGRhdGEucm93c1swXS5pbnNlcnRJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyKS50b1VwcGVyQ2FzZSgpO1xuICAgIGRhdGEucm93c1swXS5qc29uID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgICBkYXRhLnJvd3NbMF0uanNvbi50cyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcblxuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgZnVuY3Rpb24gbG9nRXZlbnQodGFibGUsIHBhcmFtcykge1xuICAgIGdldEV2ZW50UGFyYW1zKHBhcmFtcywgZnVuY3Rpb24oanNvbikge1xuICAgICAgaWYgKGpzb24gIT09IG51bGwpIHtcbiAgICAgICAgUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyLmxvZyh0YWJsZSwganNvbik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBsb2dFdmVudFRvUGxheWVyKHRhYmxlLCBwYXJhbXMpIHtcbiAgICB0cnkge1xuICAgICAgdG9wLnBvc3RUb1BsYXllcigge1xuICAgICAgICBtZXNzYWdlOiBcIndpZGdldC1sb2dcIixcbiAgICAgICAgdGFibGU6IHRhYmxlLFxuICAgICAgICBwYXJhbXM6IEpTT04uc3RyaW5naWZ5KHBhcmFtcyksXG4gICAgICAgIHN1ZmZpeDogZ2V0U3VmZml4KClcbiAgICAgIH0gKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwid2lkZ2V0LWNvbW1vbi5sb2dFdmVudFRvUGxheWVyXCIsIGVycik7XG4gICAgfVxuICB9XG5cbiAgLyogU2V0IHRoZSBDb21wYW55IGFuZCBEaXNwbGF5IElEcy4gKi9cbiAgZnVuY3Rpb24gc2V0SWRzKGNvbXBhbnksIGRpc3BsYXkpIHtcbiAgICBjb21wYW55SWQgPSBjb21wYW55O1xuICAgIGRpc3BsYXlJZCA9IGRpc3BsYXk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRWZXJzaW9uKHZhbHVlKSB7XG4gICAgdmVyc2lvbiA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImdldEluc2VydERhdGFcIjogZ2V0SW5zZXJ0RGF0YSxcbiAgICBcImdldEZpbGVGb3JtYXRcIjogZ2V0RmlsZUZvcm1hdCxcbiAgICBcImxvZ0V2ZW50XCI6IGxvZ0V2ZW50LFxuICAgIFwibG9nRXZlbnRUb1BsYXllclwiOiBsb2dFdmVudFRvUGxheWVyLFxuICAgIFwic2V0SWRzXCI6IHNldElkcyxcbiAgICBcInNldFZlcnNpb25cIjogc2V0VmVyc2lvblxuICB9O1xufSkoKTtcblxuUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyID0gKGZ1bmN0aW9uKHV0aWxzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBSRUZSRVNIX1VSTCA9IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YzL3Rva2VuP2NsaWVudF9pZD1cIiArIFdJREdFVF9DT01NT05fQ09ORklHLkxPR0dFUl9DTElFTlRfSUQgK1xuICAgICAgXCImY2xpZW50X3NlY3JldD1cIiArIFdJREdFVF9DT01NT05fQ09ORklHLkxPR0dFUl9DTElFTlRfU0VDUkVUICtcbiAgICAgIFwiJnJlZnJlc2hfdG9rZW49XCIgKyBXSURHRVRfQ09NTU9OX0NPTkZJRy5MT0dHRVJfUkVGUkVTSF9UT0tFTiArXG4gICAgICBcIiZncmFudF90eXBlPXJlZnJlc2hfdG9rZW5cIjtcblxuICB2YXIgc2VydmljZVVybCA9IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYmlncXVlcnkvdjIvcHJvamVjdHMvY2xpZW50LXNpZGUtZXZlbnRzL2RhdGFzZXRzL1dpZGdldF9FdmVudHMvdGFibGVzL1RBQkxFX0lEL2luc2VydEFsbFwiLFxuICAgIHRocm90dGxlID0gZmFsc2UsXG4gICAgdGhyb3R0bGVEZWxheSA9IDEwMDAsXG4gICAgbGFzdEV2ZW50ID0gXCJcIixcbiAgICByZWZyZXNoRGF0ZSA9IDAsXG4gICAgdG9rZW4gPSBcIlwiO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIHJlZnJlc2hUb2tlbihjYikge1xuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIGlmIChuZXcgRGF0ZSgpIC0gcmVmcmVzaERhdGUgPCAzNTgwMDAwKSB7XG4gICAgICByZXR1cm4gY2Ioe30pO1xuICAgIH1cblxuICAgIHhoci5vcGVuKFwiUE9TVFwiLCBSRUZSRVNIX1VSTCwgdHJ1ZSk7XG4gICAgeGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlc3AgPSB7fTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlc3AgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZSk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiQ2FuJ3QgcmVmcmVzaCBsb2dnZXIgdG9rZW4gLSBcIiwgZS5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIGNiKHsgdG9rZW46IHJlc3AuYWNjZXNzX3Rva2VuLCByZWZyZXNoZWRBdDogbmV3IERhdGUoKSB9KTtcbiAgICB9O1xuXG4gICAgeGhyLnNlbmQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVGhyb3R0bGVkKGV2ZW50KSB7XG4gICAgcmV0dXJuIHRocm90dGxlICYmIChsYXN0RXZlbnQgPT09IGV2ZW50KTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gbG9nKHRhYmxlTmFtZSwgcGFyYW1zKSB7XG4gICAgaWYgKCF0YWJsZU5hbWUgfHwgIXBhcmFtcyB8fCAocGFyYW1zLmhhc093blByb3BlcnR5KFwiZXZlbnRcIikgJiYgIXBhcmFtcy5ldmVudCkgfHxcbiAgICAgIChwYXJhbXMuaGFzT3duUHJvcGVydHkoXCJldmVudFwiKSAmJiBpc1Rocm90dGxlZChwYXJhbXMuZXZlbnQpKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGRvbid0IGxvZyBpZiBkaXNwbGF5IGlkIGlzIGludmFsaWQgb3IgcHJldmlldy9sb2NhbFxuICAgIGlmICghcGFyYW1zLmRpc3BsYXlfaWQgfHwgcGFyYW1zLmRpc3BsYXlfaWQgPT09IFwicHJldmlld1wiIHx8IHBhcmFtcy5kaXNwbGF5X2lkID09PSBcImRpc3BsYXlfaWRcIiB8fFxuICAgICAgcGFyYW1zLmRpc3BsYXlfaWQgPT09IFwiZGlzcGxheUlkXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaWYgKCB0b3AucG9zdFRvUGxheWVyICYmIHRvcC5lbmFibGVXaWRnZXRMb2dnaW5nICkge1xuICAgICAgICAvLyBzZW5kIGxvZyBkYXRhIHRvIHBsYXllciBpbnN0ZWFkIG9mIEJRXG4gICAgICAgIHJldHVybiB1dGlscy5sb2dFdmVudFRvUGxheWVyKCB0YWJsZU5hbWUsIHBhcmFtcyApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKCBlICkge1xuICAgICAgY29uc29sZS5sb2coIFwid2lkZ2V0LWNvbW1vbjogbG9nZ2VyXCIsIGUgKTtcbiAgICB9XG5cbiAgICB0aHJvdHRsZSA9IHRydWU7XG4gICAgbGFzdEV2ZW50ID0gcGFyYW1zLmV2ZW50O1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB0aHJvdHRsZSA9IGZhbHNlO1xuICAgIH0sIHRocm90dGxlRGVsYXkpO1xuXG4gICAgZnVuY3Rpb24gaW5zZXJ0V2l0aFRva2VuKHJlZnJlc2hEYXRhKSB7XG4gICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgIGluc2VydERhdGEsIHVybDtcblxuICAgICAgdXJsID0gc2VydmljZVVybC5yZXBsYWNlKFwiVEFCTEVfSURcIiwgdGFibGVOYW1lKTtcbiAgICAgIHJlZnJlc2hEYXRlID0gcmVmcmVzaERhdGEucmVmcmVzaGVkQXQgfHwgcmVmcmVzaERhdGU7XG4gICAgICB0b2tlbiA9IHJlZnJlc2hEYXRhLnRva2VuIHx8IHRva2VuO1xuICAgICAgaW5zZXJ0RGF0YSA9IHV0aWxzLmdldEluc2VydERhdGEocGFyYW1zKTtcblxuICAgICAgLy8gSW5zZXJ0IHRoZSBkYXRhLlxuICAgICAgeGhyLm9wZW4oXCJQT1NUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIgKyB0b2tlbik7XG5cbiAgICAgIGlmIChwYXJhbXMuY2IgJiYgdHlwZW9mIHBhcmFtcy5jYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHhoci5vbmxvYWRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBwYXJhbXMuY2IoeGhyLnJlc3BvbnNlKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoaW5zZXJ0RGF0YSkpO1xuICAgIH1cblxuICAgIHJldHVybiByZWZyZXNoVG9rZW4oaW5zZXJ0V2l0aFRva2VuKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJsb2dcIjogbG9nXG4gIH07XG59KShSaXNlVmlzaW9uLkNvbW1vbi5Mb2dnZXJVdGlscyk7XG5cbi8qIGdsb2JhbCBXZWJGb250ICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uVXRpbGl0aWVzID0gKGZ1bmN0aW9uKCkge1xuXG4gIGZ1bmN0aW9uIGdldEZvbnRDc3NTdHlsZShjbGFzc05hbWUsIGZvbnRPYmopIHtcbiAgICB2YXIgZmFtaWx5ID0gXCJmb250LWZhbWlseTogXCIgKyBkZWNvZGVVUklDb21wb25lbnQoZm9udE9iai5mb250LmZhbWlseSkucmVwbGFjZSgvJy9nLCBcIlwiKSArIFwiOyBcIjtcbiAgICB2YXIgY29sb3IgPSBcImNvbG9yOiBcIiArIChmb250T2JqLmNvbG9yID8gZm9udE9iai5jb2xvciA6IGZvbnRPYmouZm9yZWNvbG9yKSArIFwiOyBcIjtcbiAgICB2YXIgc2l6ZSA9IFwiZm9udC1zaXplOiBcIiArIChmb250T2JqLnNpemUuaW5kZXhPZihcInB4XCIpID09PSAtMSA/IGZvbnRPYmouc2l6ZSArIFwicHg7IFwiIDogZm9udE9iai5zaXplICsgXCI7IFwiKTtcbiAgICB2YXIgd2VpZ2h0ID0gXCJmb250LXdlaWdodDogXCIgKyAoZm9udE9iai5ib2xkID8gXCJib2xkXCIgOiBcIm5vcm1hbFwiKSArIFwiOyBcIjtcbiAgICB2YXIgaXRhbGljID0gXCJmb250LXN0eWxlOiBcIiArIChmb250T2JqLml0YWxpYyA/IFwiaXRhbGljXCIgOiBcIm5vcm1hbFwiKSArIFwiOyBcIjtcbiAgICB2YXIgdW5kZXJsaW5lID0gXCJ0ZXh0LWRlY29yYXRpb246IFwiICsgKGZvbnRPYmoudW5kZXJsaW5lID8gXCJ1bmRlcmxpbmVcIiA6IFwibm9uZVwiKSArIFwiOyBcIjtcbiAgICB2YXIgaGlnaGxpZ2h0ID0gXCJiYWNrZ3JvdW5kLWNvbG9yOiBcIiArIChmb250T2JqLmhpZ2hsaWdodENvbG9yID8gZm9udE9iai5oaWdobGlnaHRDb2xvciA6IGZvbnRPYmouYmFja2NvbG9yKSArIFwiO1wiO1xuXG4gICAgcmV0dXJuIFwiLlwiICsgY2xhc3NOYW1lICsgXCIge1wiICsgZmFtaWx5ICsgY29sb3IgKyBzaXplICsgd2VpZ2h0ICsgaXRhbGljICsgdW5kZXJsaW5lICsgaGlnaGxpZ2h0ICsgXCJ9XCI7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRDU1NSdWxlcyhydWxlcykge1xuICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBydWxlcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocnVsZXNbaV0pKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuXG4gIC8qXG4gICAqIExvYWRzIEdvb2dsZSBvciBjdXN0b20gZm9udHMsIGlmIGFwcGxpY2FibGUsIGFuZCBpbmplY3RzIENTUyBzdHlsZXNcbiAgICogaW50byB0aGUgaGVhZCBvZiB0aGUgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSAgICBhcnJheSAgICBzZXR0aW5ncyAgICBBcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIGZvbGxvd2luZyBmb3JtOlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt7XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwiZGF0ZVwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmb250U2V0dGluZ1wiOiB7XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCJibGFja1wiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbWlseTogXCJBa3JvbmltXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiBcIkFrcm9uaW1cIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiVmVyZGFuYVwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJnb29nbGVcIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCJodHRwOi8vY3VzdG9tLWZvbnQtdXJsXCJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodENvbG9yOiBcInRyYW5zcGFyZW50XCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRhbGljOiBmYWxzZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBcIjIwXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kZXJsaW5lOiBmYWxzZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAqXG4gICAqICAgICAgICAgICBvYmplY3QgICBjb250ZW50RG9jICAgIERvY3VtZW50IG9iamVjdCBpbnRvIHdoaWNoIHRvIGluamVjdCBzdHlsZXNcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGxvYWQgZm9udHMgKG9wdGlvbmFsKS5cbiAgICovXG4gIGZ1bmN0aW9uIGxvYWRGb250cyhzZXR0aW5ncywgY2IpIHtcbiAgICB2YXIgZmFtaWxpZXMgPSBudWxsLFxuICAgICAgZ29vZ2xlRmFtaWxpZXMgPSBbXSxcbiAgICAgIGN1c3RvbUZhbWlsaWVzID0gW10sXG4gICAgICBjdXN0b21VcmxzID0gW107XG5cbiAgICBmdW5jdGlvbiBjYWxsYmFjaygpIHtcbiAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjYigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uR29vZ2xlRm9udHNMb2FkZWQoKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH1cblxuICAgIGlmICghc2V0dGluZ3MgfHwgc2V0dGluZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBjdXN0b20gY3NzIGNsYXNzIG5hbWVzIGFuZCBhZGQgcnVsZXMgaWYgc29cbiAgICBzZXR0aW5ncy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNsYXNzICYmIGl0ZW0uZm9udFN0eWxlKSB7XG4gICAgICAgIGFkZENTU1J1bGVzKFsgZ2V0Rm9udENzc1N0eWxlKGl0ZW0uY2xhc3MsIGl0ZW0uZm9udFN0eWxlKSBdKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEdvb2dsZSBmb250c1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2V0dGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzZXR0aW5nc1tpXS5mb250U3R5bGUgJiYgc2V0dGluZ3NbaV0uZm9udFN0eWxlLmZvbnQudHlwZSAmJlxuICAgICAgICAoc2V0dGluZ3NbaV0uZm9udFN0eWxlLmZvbnQudHlwZSA9PT0gXCJnb29nbGVcIikpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGZhbGxiYWNrIGZvbnQuXG4gICAgICAgIGZhbWlsaWVzID0gc2V0dGluZ3NbaV0uZm9udFN0eWxlLmZvbnQuZmFtaWx5LnNwbGl0KFwiLFwiKVswXTtcblxuICAgICAgICAvLyBzdHJpcCBwb3NzaWJsZSBzaW5nbGUgcXVvdGVzXG4gICAgICAgIGZhbWlsaWVzID0gZmFtaWxpZXMucmVwbGFjZSgvJy9nLCBcIlwiKTtcblxuICAgICAgICBnb29nbGVGYW1pbGllcy5wdXNoKGZhbWlsaWVzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDdXN0b20gZm9udHNcbiAgICBmb3IgKGkgPSAwOyBpIDwgc2V0dGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzZXR0aW5nc1tpXS5mb250U3R5bGUgJiYgc2V0dGluZ3NbaV0uZm9udFN0eWxlLmZvbnQudHlwZSAmJlxuICAgICAgICAoc2V0dGluZ3NbaV0uZm9udFN0eWxlLmZvbnQudHlwZSA9PT0gXCJjdXN0b21cIikpIHtcbiAgICAgICAgLy8gZGVjb2RlIHZhbHVlIGFuZCBzdHJpcCBzaW5nbGUgcXVvdGVzXG4gICAgICAgIGN1c3RvbUZhbWlsaWVzLnB1c2goZGVjb2RlVVJJQ29tcG9uZW50KHNldHRpbmdzW2ldLmZvbnRTdHlsZS5mb250LmZhbWlseSkucmVwbGFjZSgvJy9nLCBcIlwiKSk7XG4gICAgICAgIC8vIHN0cmlwIHNpbmdsZSBxdW90ZXNcbiAgICAgICAgY3VzdG9tVXJscy5wdXNoKHNldHRpbmdzW2ldLmZvbnRTdHlsZS5mb250LnVybC5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIikpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChnb29nbGVGYW1pbGllcy5sZW5ndGggPT09IDAgJiYgY3VzdG9tRmFtaWxpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIC8vIExvYWQgdGhlIGZvbnRzXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGN1c3RvbUZhbWlsaWVzLmxlbmd0aDsgaiArPSAxKSB7XG4gICAgICAgIGxvYWRDdXN0b21Gb250KGN1c3RvbUZhbWlsaWVzW2pdLCBjdXN0b21VcmxzW2pdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGdvb2dsZUZhbWlsaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbG9hZEdvb2dsZUZvbnRzKGdvb2dsZUZhbWlsaWVzLCBvbkdvb2dsZUZvbnRzTG9hZGVkKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRDdXN0b21Gb250KGZhbWlseSwgdXJsLCBjb250ZW50RG9jKSB7XG4gICAgdmFyIHNoZWV0ID0gbnVsbDtcbiAgICB2YXIgcnVsZSA9IFwiZm9udC1mYW1pbHk6IFwiICsgZmFtaWx5ICsgXCI7IFwiICsgXCJzcmM6IHVybCgnXCIgKyB1cmwgKyBcIicpO1wiO1xuXG4gICAgY29udGVudERvYyA9IGNvbnRlbnREb2MgfHwgZG9jdW1lbnQ7XG5cbiAgICBzaGVldCA9IGNvbnRlbnREb2Muc3R5bGVTaGVldHNbMF07XG5cbiAgICBpZiAoc2hlZXQgIT09IG51bGwpIHtcbiAgICAgIHNoZWV0LmFkZFJ1bGUoXCJAZm9udC1mYWNlXCIsIHJ1bGUpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRHb29nbGVGb250cyhmYW1pbGllcywgY2IpIHtcbiAgICBXZWJGb250LmxvYWQoe1xuICAgICAgZ29vZ2xlOiB7XG4gICAgICAgIGZhbWlsaWVzOiBmYW1pbGllc1xuICAgICAgfSxcbiAgICAgIGFjdGl2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbmFjdGl2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0aW1lb3V0OiAyMDAwXG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkU2NyaXB0KCBzcmMgKSB7XG4gICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwic2NyaXB0XCIgKTtcblxuICAgIHNjcmlwdC5zcmMgPSBzcmM7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggc2NyaXB0ICk7XG4gIH1cblxuICBmdW5jdGlvbiBwcmVsb2FkSW1hZ2VzKHVybHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gdXJscy5sZW5ndGgsXG4gICAgICBpbWFnZXMgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGltYWdlc1tpXSA9IG5ldyBJbWFnZSgpO1xuICAgICAgaW1hZ2VzW2ldLnNyYyA9IHVybHNbaV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBVUkkgcXVlcnkgcGFyYW1cbiAgICovXG4gIGZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1ldGVyKHBhcmFtKSB7XG4gICAgcmV0dXJuIGdldFF1ZXJ5U3RyaW5nUGFyYW1ldGVyKHBhcmFtLCB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBxdWVyeSBwYXJhbWV0ZXIgZnJvbSBhIHF1ZXJ5IHN0cmluZ1xuICAgKi9cbiAgZnVuY3Rpb24gZ2V0UXVlcnlTdHJpbmdQYXJhbWV0ZXIocGFyYW0sIHF1ZXJ5KSB7XG4gICAgdmFyIHZhcnMgPSBxdWVyeS5zcGxpdChcIiZcIiksXG4gICAgICBwYWlyO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwYWlyID0gdmFyc1tpXS5zcGxpdChcIj1cIik7XG5cbiAgICAgIGlmIChwYWlyWzBdID09IHBhcmFtKSB7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkYXRlIG9iamVjdCBmcm9tIHBsYXllciB2ZXJzaW9uIHN0cmluZ1xuICAgKi9cbiAgZnVuY3Rpb24gZ2V0RGF0ZU9iamVjdEZyb21QbGF5ZXJWZXJzaW9uU3RyaW5nKHBsYXllclZlcnNpb24pIHtcbiAgICB2YXIgcmVnZ2llID0gLyhcXGR7NH0pXFwuKFxcZHsyfSlcXC4oXFxkezJ9KVxcLihcXGR7Mn0pXFwuKFxcZHsyfSkvO1xuICAgIHZhciBkYXRlQXJyYXkgPSByZWdnaWUuZXhlYyhwbGF5ZXJWZXJzaW9uKTtcbiAgICBpZiAoZGF0ZUFycmF5KSB7XG4gICAgICByZXR1cm4gbmV3IERhdGUoXG4gICAgICAgICgrZGF0ZUFycmF5WzFdKSxcbiAgICAgICAgICAoK2RhdGVBcnJheVsyXSktMSwgLy8gQ2FyZWZ1bCwgbW9udGggc3RhcnRzIGF0IDAhXG4gICAgICAgICgrZGF0ZUFycmF5WzNdKSxcbiAgICAgICAgKCtkYXRlQXJyYXlbNF0pLFxuICAgICAgICAoK2RhdGVBcnJheVs1XSlcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRSaXNlQ2FjaGVFcnJvck1lc3NhZ2Uoc3RhdHVzQ29kZSkge1xuICAgIHZhciBlcnJvck1lc3NhZ2UgPSBcIlwiO1xuICAgIHN3aXRjaCAoc3RhdHVzQ29kZSkge1xuICAgICAgY2FzZSA0MDQ6XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IFwiVGhlIGZpbGUgZG9lcyBub3QgZXhpc3Qgb3IgY2Fubm90IGJlIGFjY2Vzc2VkLlwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNTA3OlxuICAgICAgICBlcnJvck1lc3NhZ2UgPSBcIlRoZXJlIGlzIG5vdCBlbm91Z2ggZGlzayBzcGFjZSB0byBzYXZlIHRoZSBmaWxlIG9uIFJpc2UgQ2FjaGUuXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gXCJUaGVyZSB3YXMgYSBwcm9ibGVtIHJldHJpZXZpbmcgdGhlIGZpbGUgZnJvbSBSaXNlIENhY2hlLlwiO1xuICAgIH1cblxuICAgIHJldHVybiBlcnJvck1lc3NhZ2U7XG4gIH1cblxuICBmdW5jdGlvbiB1bmVzY2FwZUhUTUwoaHRtbCkge1xuICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gICAgZGl2LmlubmVySFRNTCA9IGh0bWw7XG5cbiAgICByZXR1cm4gZGl2LnRleHRDb250ZW50O1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzSW50ZXJuZXRDb25uZWN0aW9uKGZpbGVQYXRoLCBjYWxsYmFjaykge1xuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIGlmICghZmlsZVBhdGggfHwgIWNhbGxiYWNrIHx8IHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgeGhyLm9wZW4oXCJIRUFEXCIsIGZpbGVQYXRoICsgXCI/Y2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSwgZmFsc2UpO1xuXG4gICAgdHJ5IHtcbiAgICAgIHhoci5zZW5kKCk7XG5cbiAgICAgIGNhbGxiYWNrKCh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzA0KSk7XG5cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjYWxsYmFjayhmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGNocm9tZSB2ZXJzaW9uIGlzIHVuZGVyIGEgY2VydGFpbiB2ZXJzaW9uXG4gICAqL1xuICBmdW5jdGlvbiBpc0xlZ2FjeSgpIHtcbiAgICB2YXIgbGVnYWN5VmVyc2lvbiA9IDI1O1xuXG4gICAgdmFyIG1hdGNoID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQ2hyb21lXFwvKFxcUyspLyk7XG4gICAgdmFyIHZlcnNpb24gPSBtYXRjaCA/IG1hdGNoWzFdIDogMDtcblxuICAgIGlmICh2ZXJzaW9uKSB7XG4gICAgICB2ZXJzaW9uID0gcGFyc2VJbnQodmVyc2lvbi5zdWJzdHJpbmcoMCx2ZXJzaW9uLmluZGV4T2YoXCIuXCIpKSk7XG5cbiAgICAgIGlmICh2ZXJzaW9uIDw9IGxlZ2FjeVZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgaHR0cDovLyBvciBodHRwczovLyBwcm90b2NvbCB0byB1cmwgaWYgdGhlIHByb3RvY29sIGlzIG1pc3NpbmdcbiAgICovXG4gIGZ1bmN0aW9uIGFkZFByb3RvY29sKHVybCwgc2VjdXJlKSB7XG4gICAgaWYgKCEvXig/OmZ8aHQpdHBzP1xcOlxcL1xcLy8udGVzdCh1cmwpKSB7XG4gICAgICB1cmwgPSAoKHNlY3VyZSkgPyBcImh0dHBzOi8vXCIgOiBcImh0dHA6Ly9cIikgKyB1cmw7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZFByb3RvY29sOiAgICAgICAgICAgICAgYWRkUHJvdG9jb2wsXG4gICAgZ2V0UXVlcnlQYXJhbWV0ZXI6ICAgICAgICBnZXRRdWVyeVBhcmFtZXRlcixcbiAgICBnZXRRdWVyeVN0cmluZ1BhcmFtZXRlcjogIGdldFF1ZXJ5U3RyaW5nUGFyYW1ldGVyLFxuICAgIGdldEZvbnRDc3NTdHlsZTogICAgICAgICAgZ2V0Rm9udENzc1N0eWxlLFxuICAgIGFkZENTU1J1bGVzOiAgICAgICAgICAgICAgYWRkQ1NTUnVsZXMsXG4gICAgbG9hZEZvbnRzOiAgICAgICAgICAgICAgICBsb2FkRm9udHMsXG4gICAgbG9hZEN1c3RvbUZvbnQ6ICAgICAgICAgICBsb2FkQ3VzdG9tRm9udCxcbiAgICBsb2FkR29vZ2xlRm9udHM6ICAgICAgICAgIGxvYWRHb29nbGVGb250cyxcbiAgICBsb2FkU2NyaXB0OiAgICAgICAgICAgICAgIGxvYWRTY3JpcHQsXG4gICAgcHJlbG9hZEltYWdlczogICAgICAgICAgICBwcmVsb2FkSW1hZ2VzLFxuICAgIGdldFJpc2VDYWNoZUVycm9yTWVzc2FnZTogZ2V0UmlzZUNhY2hlRXJyb3JNZXNzYWdlLFxuICAgIHVuZXNjYXBlSFRNTDogICAgICAgICAgICAgdW5lc2NhcGVIVE1MLFxuICAgIGhhc0ludGVybmV0Q29ubmVjdGlvbjogICAgaGFzSW50ZXJuZXRDb25uZWN0aW9uLFxuICAgIGlzTGVnYWN5OiAgICAgICAgICAgICAgICAgaXNMZWdhY3ksXG4gICAgZ2V0RGF0ZU9iamVjdEZyb21QbGF5ZXJWZXJzaW9uU3RyaW5nOiBnZXREYXRlT2JqZWN0RnJvbVBsYXllclZlcnNpb25TdHJpbmdcbiAgfTtcbn0pKCk7XG5cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xudmFyIGNvbmZpZyA9IHtcbiAgU1RPUkFHRV9FTlY6IFwicHJvZFwiXG59O1xuXG5pZiAoIHR5cGVvZiBhbmd1bGFyICE9PSBcInVuZGVmaW5lZFwiICkge1xuICBhbmd1bGFyLm1vZHVsZSggXCJyaXNldmlzaW9uLmNvbW1vbi5pMThuLmNvbmZpZ1wiLCBbXSApXG4gICAgLmNvbnN0YW50KCBcIkxPQ0FMRVNfUFJFRklYXCIsIFwibG9jYWxlcy90cmFuc2xhdGlvbl9cIiApXG4gICAgLmNvbnN0YW50KCBcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiICk7XG59XG5cbi8qIGdsb2JhbCBnYWRnZXRzICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5XZWJQYWdlID0ge307XG5cblJpc2VWaXNpb24uV2ViUGFnZSA9ICggZnVuY3Rpb24oIGRvY3VtZW50LCBnYWRnZXRzICkge1xuXG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIC8vIHByaXZhdGUgdmFyaWFibGVzXG4gIHZhciBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpLFxuICAgIF91dGlscyA9IFJpc2VWaXNpb24uQ29tbW9uLlV0aWxpdGllcyxcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IG51bGwsXG4gICAgX3VybCA9IFwiXCIsXG4gICAgX3ZlcnRpY2FsID0gMCxcbiAgICBfaW50ZXJ2YWxJZCA9IG51bGwsXG4gICAgX2luaXRpYWxMb2FkID0gdHJ1ZSxcbiAgICBfd2lkdGhPZmZzZXQgPSAwLFxuICAgIF9tZXNzYWdlID0gbnVsbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKCBcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyggXCJpZFwiICksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCBmYWxzZSApO1xuICB9XG5cbiAgZnVuY3Rpb24gX3NldEludGVyYWN0aXZpdHkoIGZyYW1lICkge1xuICAgIHZhciBibG9ja2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXCIuYmxvY2tlclwiICk7XG5cbiAgICBibG9ja2VyLnN0eWxlLmRpc3BsYXkgPSAoIF9hZGRpdGlvbmFsUGFyYW1zLmludGVyYWN0aXZpdHkuaW50ZXJhY3RpdmUgKSA/IFwibm9uZVwiIDogXCJibG9ja1wiO1xuXG4gICAgZnJhbWUuc2V0QXR0cmlidXRlKCBcInNjcm9sbGluZ1wiLFxuICAgICAgKCBfYWRkaXRpb25hbFBhcmFtcy5pbnRlcmFjdGl2aXR5LmludGVyYWN0aXZlICYmIF9hZGRpdGlvbmFsUGFyYW1zLmludGVyYWN0aXZpdHkuc2Nyb2xsYmFycyApID8gXCJ5ZXNcIiA6IFwibm9cIiApO1xuICB9XG5cbiAgZnVuY3Rpb24gX3NldEFzcGVjdFJhdGlvKCkge1xuICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggXCJjb250YWluZXJcIiApLFxuICAgICAgYXNwZWN0UmF0aW8gPSAoIF9wcmVmcy5nZXRJbnQoIFwicnNIXCIgKSAvIF9wcmVmcy5nZXRJbnQoIFwicnNXXCIgKSApICogMTAwO1xuXG4gICAgaWYgKCBjb250YWluZXIgKSB7XG4gICAgICAvLyBpbXBsZW1lbnQgcmVzcG9uc2l2ZSBpZnJhbWVcbiAgICAgIGlmICggX3ZlcnRpY2FsICE9PSAwICkge1xuICAgICAgICBhc3BlY3RSYXRpbyArPSAoIF92ZXJ0aWNhbCAvIF9wcmVmcy5nZXRJbnQoIFwicnNXXCIgKSApICogMTAwO1xuICAgICAgfVxuXG4gICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCBcInN0eWxlXCIsIFwicGFkZGluZy1ib3R0b206XCIgKyBhc3BlY3RSYXRpbyArIFwiJVwiICk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX3NldFpvb20oIGZyYW1lICkge1xuICAgIHZhciB6b29tID0gcGFyc2VGbG9hdCggX2FkZGl0aW9uYWxQYXJhbXMuem9vbSApLFxuICAgICAgY3VycmVudFN0eWxlID0gXCJcIixcbiAgICAgIHpvb21TdHlsZSA9IFwiXCI7XG5cbiAgICAvLyBDb25maWd1cmUgdGhlIHpvb20gKHNjYWxlKSBzdHlsaW5nXG4gICAgem9vbVN0eWxlID0gXCItbXMtem9vbTpcIiArIHpvb20gKyBcIjtcIiArXG4gICAgICBcIi1tb3otdHJhbnNmb3JtOiBzY2FsZShcIiArIHpvb20gKyBcIik7XCIgK1xuICAgICAgXCItbW96LXRyYW5zZm9ybS1vcmlnaW46IDAgMDtcIiArXG4gICAgICBcIi1vLXRyYW5zZm9ybTogc2NhbGUoXCIgKyB6b29tICsgXCIpO1wiICtcbiAgICAgIFwiLW8tdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgIFwiLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKFwiICsgem9vbSArIFwiKTtcIiArXG4gICAgICBcIi13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgIFwidHJhbnNmb3JtOiBzY2FsZShcIiArIHpvb20gKyBcIik7XCIgK1xuICAgICAgXCJ0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XCI7XG5cbiAgICBjdXJyZW50U3R5bGUgPSBmcmFtZS5nZXRBdHRyaWJ1dGUoIFwic3R5bGVcIiApO1xuICAgIHpvb21TdHlsZSArPSBcIndpZHRoOiBcIiArICggKCAoIDEgLyB6b29tICkgKiAxMDAgKSArIF93aWR0aE9mZnNldCApICsgXCIlO1wiICtcbiAgICAgIFwiaGVpZ2h0OiBcIiArICggKCAxIC8gem9vbSApICogMTAwICkgKyBcIiU7XCI7XG5cbiAgICBpZiAoIGN1cnJlbnRTdHlsZSApIHtcbiAgICAgIHpvb21TdHlsZSA9IGN1cnJlbnRTdHlsZSArIHpvb21TdHlsZTtcbiAgICB9XG5cbiAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoIFwic3R5bGVcIiwgem9vbVN0eWxlICk7XG4gIH1cblxuICBmdW5jdGlvbiBfc2V0UmVnaW9uKCBmcmFtZSApIHtcbiAgICB2YXIgY3VycmVudFN0eWxlID0gXCJcIixcbiAgICAgIG1hcmdpblN0eWxlID0gXCJcIixcbiAgICAgIGhvcml6b250YWwgPSAwO1xuXG4gICAgaWYgKCBfYWRkaXRpb25hbFBhcmFtcy5yZWdpb24gJiYgX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnNob3dSZWdpb24gJiZcbiAgICAgICggX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnNob3dSZWdpb24gPT09IFwicmVnaW9uXCIgKSApIHtcbiAgICAgIGlmICggX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLmhvcml6b250YWwgPiAwICkge1xuICAgICAgICBob3Jpem9udGFsID0gX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLmhvcml6b250YWw7XG4gICAgICB9XG5cbiAgICAgIGlmICggX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnZlcnRpY2FsID4gMCApIHtcbiAgICAgICAgX3ZlcnRpY2FsID0gX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnZlcnRpY2FsO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSBuZWdhdGl2ZSBtYXJnaW5zIGluIG9yZGVyIHRvIHNob3cgYSByZWdpb24uXG4gICAgICBpZiAoICggaG9yaXpvbnRhbCAhPT0gMCApIHx8ICggX3ZlcnRpY2FsICE9PSAwICkgKSB7XG4gICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgd2lkdGggb2Zmc2V0IHdoZW4gcmVnaW9uIGlzIGNob3Nlbi5cbiAgICAgICAgX3dpZHRoT2Zmc2V0ID0gKCBob3Jpem9udGFsICogMTAwICkgLyBfcHJlZnMuZ2V0SW50KCBcInJzV1wiICk7XG5cbiAgICAgICAgY3VycmVudFN0eWxlID0gZnJhbWUuZ2V0QXR0cmlidXRlKCBcInN0eWxlXCIgKTtcbiAgICAgICAgbWFyZ2luU3R5bGUgPSBcIm1hcmdpbjogXCIgKyBcIi1cIiArIF92ZXJ0aWNhbCArIFwicHggMCAwIC1cIiArIGhvcml6b250YWwgKyBcInB4O1wiO1xuXG4gICAgICAgIGlmICggY3VycmVudFN0eWxlICkge1xuICAgICAgICAgIG1hcmdpblN0eWxlID0gY3VycmVudFN0eWxlICsgbWFyZ2luU3R5bGU7XG4gICAgICAgIH1cblxuICAgICAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoIFwic3R5bGVcIiwgbWFyZ2luU3R5bGUgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnRSZWZyZXNoSW50ZXJ2YWwoKSB7XG4gICAgX2ludGVydmFsSWQgPSBzZXRJbnRlcnZhbCggZnVuY3Rpb24oKSB7XG4gICAgICBfdXRpbHMuaGFzSW50ZXJuZXRDb25uZWN0aW9uKCBcImltZy90cmFuc3BhcmVudC5wbmdcIiwgZnVuY3Rpb24oIGhhc0ludGVybmV0ICkge1xuICAgICAgICBpZiAoIGhhc0ludGVybmV0ICkge1xuICAgICAgICAgIF9sb2FkRnJhbWUoKTtcbiAgICAgICAgfVxuICAgICAgfSApO1xuICAgIH0sIF9hZGRpdGlvbmFsUGFyYW1zLnJlZnJlc2ggKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9nZXRGcmFtZUVsZW1lbnQoKSB7XG4gICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJpZnJhbWVcIiApLFxuICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIFwiY29udGFpbmVyXCIgKTtcblxuICAgIGZyYW1lLmNsYXNzTmFtZSA9IFwid2VicGFnZS1mcmFtZVwiO1xuICAgIGZyYW1lLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgIGZyYW1lLnNldEF0dHJpYnV0ZSggXCJmcmFtZWJvcmRlclwiLCBcIjBcIiApO1xuICAgIGZyYW1lLnNldEF0dHJpYnV0ZSggXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCBcInRydWVcIiApO1xuICAgIGZyYW1lLnNldEF0dHJpYnV0ZSggXCJzYW5kYm94XCIsIFwiYWxsb3ctZm9ybXMgYWxsb3ctc2FtZS1vcmlnaW4gYWxsb3ctc2NyaXB0c1wiICk7XG5cbiAgICBfc2V0SW50ZXJhY3Rpdml0eSggZnJhbWUgKTtcbiAgICBfc2V0UmVnaW9uKCBmcmFtZSApO1xuICAgIF9zZXRab29tKCBmcmFtZSApO1xuICAgIF9zZXRBc3BlY3RSYXRpbygpO1xuXG4gICAgZnJhbWUub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLm9ubG9hZCA9IG51bGw7XG4gICAgICB0aGlzLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcblxuICAgICAgX2luaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICAgIC8vIGNoZWNrIGlmIHJlZnJlc2ggaW50ZXJ2YWwgc2hvdWxkIGJlIHN0YXJ0ZWRcbiAgICAgIGlmICggX2FkZGl0aW9uYWxQYXJhbXMucmVmcmVzaCA+IDAgJiYgX2ludGVydmFsSWQgPT09IG51bGwgKSB7XG4gICAgICAgIF9zdGFydFJlZnJlc2hJbnRlcnZhbCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIFwiLndlYnBhZ2UtZnJhbWVcIiApLmxlbmd0aCA+IDEgKSB7XG4gICAgICAgIC8vIFJlZnJlc2ggb2NjdXJyZWQsIHJlbW92ZSBvbGQgaWZyYW1lXG4gICAgICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZCggZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXCIud2VicGFnZS1mcmFtZVwiICkgKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGZyYW1lO1xuICB9XG5cbiAgZnVuY3Rpb24gX2xvYWRGcmFtZSgpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIFwiY29udGFpbmVyXCIgKSxcbiAgICAgIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuICAgICAgZnJhbWUgPSBfZ2V0RnJhbWVFbGVtZW50KCk7XG5cbiAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoIFwic3JjXCIsIF91cmwgKTtcblxuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKCBmcmFtZSApO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZnJhZ21lbnQgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF91bmxvYWRGcmFtZSgpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIFwiY29udGFpbmVyXCIgKSxcbiAgICAgIGZyYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXCIud2VicGFnZS1mcmFtZVwiICk7XG5cbiAgICBpZiAoIF9hZGRpdGlvbmFsUGFyYW1zLnJlZnJlc2ggPiAwICkge1xuICAgICAgY2xlYXJJbnRlcnZhbCggX2ludGVydmFsSWQgKTtcbiAgICAgIF9pbnRlcnZhbElkID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoIGZyYW1lICkge1xuICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKCBmcmFtZSApO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gX2luaXQoKSB7XG4gICAgX21lc3NhZ2UgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uTWVzc2FnZSggZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIFwiY29udGFpbmVyXCIgKSxcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBcIm1lc3NhZ2VDb250YWluZXJcIiApICk7XG5cbiAgICAvLyBhcHBseSBoZWlnaHQgdmFsdWUgdG8gbWVzc2FnZSBjb250YWluZXIgc28gYSBtZXNzYWdlIGdldHMgdmVydGljYWxseSBjZW50ZXJlZFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBcIm1lc3NhZ2VDb250YWluZXJcIiApLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoIFwicnNIXCIgKSArIFwicHhcIjtcblxuICAgIC8vIENvbmZpZ3VyZSB0aGUgdmFsdWUgZm9yIF91cmxcbiAgICBfdXJsID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsO1xuXG4gICAgLy8gQWRkIGh0dHA6Ly8gaWYgbm8gcHJvdG9jb2wgcGFyYW1ldGVyIGV4aXN0c1xuICAgIGlmICggX3VybC5pbmRleE9mKCBcIjovL1wiICkgPT09IC0xICkge1xuICAgICAgX3VybCA9IFwiaHR0cDovL1wiICsgX3VybDtcbiAgICB9XG5cbiAgICBfcmVhZHkoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gZ2V0VGFibGVOYW1lKCkge1xuICAgIHJldHVybiBcIndlYnBhZ2VfZXZlbnRzXCI7XG4gIH1cblxuICBmdW5jdGlvbiBsb2dFdmVudCggcGFyYW1zICkge1xuICAgIFJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlclV0aWxzLmxvZ0V2ZW50KCBnZXRUYWJsZU5hbWUoKSwgcGFyYW1zICk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBpZiAoIF9hZGRpdGlvbmFsUGFyYW1zLnVubG9hZCApIHtcbiAgICAgIF91bmxvYWRGcmFtZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG5cbiAgICBsb2dFdmVudCggeyBcImV2ZW50XCI6IFwicGxheVwiLCBcInVybFwiOiBfdXJsIH0gKTtcblxuICAgIGlmICggX2luaXRpYWxMb2FkIHx8IF9hZGRpdGlvbmFsUGFyYW1zLnVubG9hZCApIHtcbiAgICAgIF9sb2FkRnJhbWUoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKCBhZGRpdGlvbmFsUGFyYW1zICkge1xuICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSggSlNPTi5zdHJpbmdpZnkoIGFkZGl0aW9uYWxQYXJhbXMgKSApO1xuXG4gICAgX2luaXQoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJnZXRUYWJsZU5hbWVcIjogZ2V0VGFibGVOYW1lLFxuICAgIFwibG9nRXZlbnRcIjogbG9nRXZlbnQsXG4gICAgXCJzZXRBZGRpdGlvbmFsUGFyYW1zXCI6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xuXG59ICkoIGRvY3VtZW50LCBnYWRnZXRzICk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UgPSBmdW5jdGlvbiAobWFpbkNvbnRhaW5lciwgbWVzc2FnZUNvbnRhaW5lcikge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2FjdGl2ZSA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIF9pbml0KCkge1xuICAgIHRyeSB7XG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IG1haW5Db250YWluZXIuc3R5bGUuaGVpZ2h0O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIkNhbid0IGluaXRpYWxpemUgTWVzc2FnZSAtIFwiLCBlLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaGlkZSgpIHtcbiAgICBpZiAoX2FjdGl2ZSkge1xuICAgICAgLy8gY2xlYXIgY29udGVudCBvZiBtZXNzYWdlIGNvbnRhaW5lclxuICAgICAgd2hpbGUgKG1lc3NhZ2VDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnJlbW92ZUNoaWxkKG1lc3NhZ2VDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICB9XG5cbiAgICAgIC8vIGhpZGUgbWVzc2FnZSBjb250YWluZXJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgICAvLyBzaG93IG1haW4gY29udGFpbmVyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzaG93KG1lc3NhZ2UpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgICBwO1xuXG4gICAgaWYgKCFfYWN0aXZlKSB7XG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG4gICAgICAvLyBjcmVhdGUgbWVzc2FnZSBlbGVtZW50XG4gICAgICBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgICBwLmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgICBwLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVzc2FnZVwiKTtcblxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocCk7XG4gICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuICAgICAgX2FjdGl2ZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIG1lc3NhZ2UgYWxyZWFkeSBiZWluZyBzaG93biwgdXBkYXRlIG1lc3NhZ2UgdGV4dFxuICAgICAgcCA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5tZXNzYWdlXCIpO1xuICAgICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlO1xuICAgIH1cbiAgfVxuXG4gIF9pbml0KCk7XG5cbiAgcmV0dXJuIHtcbiAgICBcImhpZGVcIjogaGlkZSxcbiAgICBcInNob3dcIjogc2hvd1xuICB9O1xufTtcblxuLyogZ2xvYmFsIFJpc2VWaXNpb24sIGdhZGdldHMgKi9cblxuKCBmdW5jdGlvbiggd2luZG93LCBkb2N1bWVudCwgZ2FkZ2V0cyApIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGlkID0gbmV3IGdhZGdldHMuUHJlZnMoKS5nZXRTdHJpbmcoIFwiaWRcIiApO1xuXG4gIC8vIERpc2FibGUgY29udGV4dCBtZW51IChyaWdodCBjbGljayBtZW51KVxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBkb2N1bWVudC5ib2R5Lm9ubW91c2Vkb3duID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZSggbmFtZXMsIHZhbHVlcyApIHtcbiAgICB2YXIgYWRkaXRpb25hbFBhcmFtcyxcbiAgICAgIGNvbXBhbnlJZCA9IFwiXCIsXG4gICAgICBkaXNwbGF5SWQgPSBcIlwiO1xuXG4gICAgaWYgKCBBcnJheS5pc0FycmF5KCBuYW1lcyApICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgQXJyYXkuaXNBcnJheSggdmFsdWVzICkgJiYgdmFsdWVzLmxlbmd0aCA+IDAgKSB7XG4gICAgICAvLyBjb21wYW55IGlkXG4gICAgICBpZiAoIG5hbWVzWyAwIF0gPT09IFwiY29tcGFueUlkXCIgKSB7XG4gICAgICAgIGNvbXBhbnlJZCA9IHZhbHVlc1sgMCBdO1xuICAgICAgfVxuXG4gICAgICAvLyBkaXNwbGF5IGlkXG4gICAgICBpZiAoIG5hbWVzWyAxIF0gPT09IFwiZGlzcGxheUlkXCIgKSB7XG4gICAgICAgIGlmICggdmFsdWVzWyAxIF0gKSB7XG4gICAgICAgICAgZGlzcGxheUlkID0gdmFsdWVzWyAxIF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGlzcGxheUlkID0gXCJwcmV2aWV3XCI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gcHJvdmlkZSBMb2dnZXJVdGlscyB0aGUgaWRzIHRvIHVzZVxuICAgICAgUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMuc2V0SWRzKCBjb21wYW55SWQsIGRpc3BsYXlJZCApO1xuXG4gICAgICAvLyBhZGRpdGlvbmFsIHBhcmFtc1xuICAgICAgaWYgKCBuYW1lc1sgMiBdID09PSBcImFkZGl0aW9uYWxQYXJhbXNcIiApIHtcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UoIHZhbHVlc1sgMiBdICk7XG5cbiAgICAgICAgUmlzZVZpc2lvbi5XZWJQYWdlLnNldEFkZGl0aW9uYWxQYXJhbXMoIGFkZGl0aW9uYWxQYXJhbXMgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uV2ViUGFnZS5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLldlYlBhZ2UucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5XZWJQYWdlLnN0b3AoKTtcbiAgfVxuXG4gIGlmICggaWQgJiYgaWQgIT09IFwiXCIgKSB7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoIFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5ICk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoIFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UgKTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlciggXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3AgKTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlciggXCJyc3BhcmFtX3NldF9cIiArIGlkLCBjb25maWd1cmUgKTtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKCBcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbIFwiY29tcGFueUlkXCIsIFwiZGlzcGxheUlkXCIsIFwiYWRkaXRpb25hbFBhcmFtc1wiIF0gKTtcbiAgfVxuXG59ICkoIHdpbmRvdywgZG9jdW1lbnQsIGdhZGdldHMgKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktNiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXX0=
